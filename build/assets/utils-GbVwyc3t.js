import{ac as m,a0 as u,bj as d,bk as g,bl as a,bm as b,Z as w,bn as z,K as A,bo as S}from"./index-r-K8bCt4.js";import{p as h,k as I,l as x,I as P,h as E}from"./to-serializable-transaction-BMbNRj8d.js";function M(e){let t;if(typeof e=="string")t=h(e);else{const s=I(e),n=e.length;for(let r=0;r<n;r++){const i=e[r];if(!x(i)){t=h(i,s);break}}}if(!t)throw new P({signature:e});return t}function f(e){return m(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function B(e,t){if(e.length!==t.length)throw new Error("The number of parameters and values must match.");const s=C({params:e,values:t}),n=l(s);return n.length===0?"0x":n}function C({params:e,values:t}){const s=[];for(let n=0;n<e.length;n++)s.push(y({param:e[n],value:t[n]}));return s}function y({param:e,value:t}){const s=L(e.type);if(s){const[n,r]=s;return T(t,{length:n,param:{...e,type:r}})}if(e.type==="tuple")return F(t,{param:e});if(e.type==="address")return H(t);if(e.type==="bool")return k(t);if(e.type.startsWith("uint")||e.type.startsWith("int")){const n=e.type.startsWith("int");return W(t,{signed:n})}if(e.type.startsWith("bytes"))return $(t,{param:e});if(e.type==="string")return _(t);throw new Error(`Unsupported parameter type: ${e.type}`)}function l(e){let t=0;for(let i=0;i<e.length;i++){const{dynamic:o,encoded:c}=e[i];o?t+=32:t+=f(c)}const s=[],n=[];let r=0;for(let i=0;i<e.length;i++){const{dynamic:o,encoded:c}=e[i];o?(s.push(u(t+r,{size:32})),n.push(c),r+=f(c)):s.push(c)}return d(...s,...n)}function H(e){if(e!==""&&e!==void 0&&!g(e))throw new Error(`Invalid address: ${e}`);return{dynamic:!1,encoded:a(e.toLowerCase())}}function T(e,{length:t,param:s}){const n=t===null;if(!Array.isArray(e))throw new Error("Invalid array value.");if(!n&&e.length!==t)throw new Error("Invalid array length.");let r=!1;const i=[];for(let o=0;o<e.length;o++){const c=y({param:s,value:e[o]});c.dynamic&&(r=!0),i.push(c)}if(n||r){const o=l(i);if(n){const c=u(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?d(c,o):c}}if(r)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:d(...i.map(({encoded:o})=>o))}}function $(e,{param:t}){const[,s]=t.type.split("bytes"),n=f(e);if(!s){let r=e;return n%32!==0&&(r=a(r,{dir:"right",size:Math.ceil((e.length-2)/2/32)*32})),{dynamic:!0,encoded:d(a(u(n,{size:32})),r)}}if(n!==Number.parseInt(s))throw new Error(`Invalid bytes${s} size: ${n}`);return{dynamic:!1,encoded:a(e,{dir:"right"})}}function k(e){return{dynamic:!1,encoded:a(b(e))}}function W(e,{signed:t}){return{dynamic:!1,encoded:u(e,{signed:t,size:32})}}function _(e){const t=w(e),s=Math.ceil(f(t)/32),n=[];for(let r=0;r<s;r++)n.push(a(z(t,r*32,(r+1)*32),{dir:"right"}));return{dynamic:!0,encoded:d(a(u(f(t),{size:32})),...n)}}function F(e,{param:t}){let s=!1;const n=[];for(let r=0;r<t.components.length;r++){const i=t.components[r],o=Array.isArray(e)?r:i.name,c=y({param:i,value:e[o]});n.push(c),c.dynamic&&(s=!0)}return{dynamic:s,encoded:s?l(n):d(...n.map(({encoded:r})=>r))}}function L(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}const p=new S(4096);function K(e){const t=typeof e=="string"?e:A(e);if(p.has(t))return p.get(t);const s=typeof e=="string"?M(e):e,r=[E(s),s.inputs,s.outputs];return p.set(t,r),r}function U(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="function")}export{M as a,B as e,U as i,K as p};
