import{a3 as In,a4 as Ln,a5 as An,a6 as xn}from"./index-r-K8bCt4.js";const Mn=(t,e)=>{let n;switch(t){case"standard":return n=e,`data:image/svg+xml,%3Csvg width='${e}' height='${n}' viewBox='0 0 1024 1024' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Crect width='1024' height='1024' fill='%230052FF'/%3E %3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 512C152 710.823 313.177 872 512 872C710.823 872 872 710.823 872 512C872 313.177 710.823 152 512 152C313.177 152 152 313.177 152 512ZM420 396C406.745 396 396 406.745 396 420V604C396 617.255 406.745 628 420 628H604C617.255 628 628 617.255 628 604V420C628 406.745 617.255 396 604 396H420Z' fill='white'/%3E %3C/svg%3E `;case"circle":return n=e,`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${n}' viewBox='0 0 999.81 999.81'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%230052fe;%7D.cls-2%7Bfill:%23fefefe;%7D.cls-3%7Bfill:%230152fe;%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M655-115.9h56c.83,1.59,2.36.88,3.56,1a478,478,0,0,1,75.06,10.42C891.4-81.76,978.33-32.58,1049.19,44q116.7,126,131.94,297.61c.38,4.14-.34,8.53,1.78,12.45v59c-1.58.84-.91,2.35-1,3.56a482.05,482.05,0,0,1-10.38,74.05c-24,106.72-76.64,196.76-158.83,268.93s-178.18,112.82-287.2,122.6c-4.83.43-9.86-.25-14.51,1.77H654c-1-1.68-2.69-.91-4.06-1a496.89,496.89,0,0,1-105.9-18.59c-93.54-27.42-172.78-77.59-236.91-150.94Q199.34,590.1,184.87,426.58c-.47-5.19.25-10.56-1.77-15.59V355c1.68-1,.91-2.7,1-4.06a498.12,498.12,0,0,1,18.58-105.9c26-88.75,72.64-164.9,140.6-227.57q126-116.27,297.21-131.61C645.32-114.57,650.35-113.88,655-115.9Zm377.92,500c0-192.44-156.31-349.49-347.56-350.15-194.13-.68-350.94,155.13-352.29,347.42-1.37,194.55,155.51,352.1,348.56,352.47C876.15,734.23,1032.93,577.84,1032.93,384.11Z' transform='translate(-183.1 115.9)'/%3E%3Cpath class='cls-2' d='M1032.93,384.11c0,193.73-156.78,350.12-351.29,349.74-193-.37-349.93-157.92-348.56-352.47C334.43,189.09,491.24,33.28,685.37,34,876.62,34.62,1032.94,191.67,1032.93,384.11ZM683,496.81q43.74,0,87.48,0c15.55,0,25.32-9.72,25.33-25.21q0-87.48,0-175c0-15.83-9.68-25.46-25.59-25.46H595.77c-15.88,0-25.57,9.64-25.58,25.46q0,87.23,0,174.45c0,16.18,9.59,25.7,25.84,25.71Z' transform='translate(-183.1 115.9)'/%3E%3Cpath class='cls-3' d='M683,496.81H596c-16.25,0-25.84-9.53-25.84-25.71q0-87.23,0-174.45c0-15.82,9.7-25.46,25.58-25.46H770.22c15.91,0,25.59,9.63,25.59,25.46q0,87.47,0,175c0,15.49-9.78,25.2-25.33,25.21Q726.74,496.84,683,496.81Z' transform='translate(-183.1 115.9)'/%3E%3C/svg%3E`;case"text":return n=(.1*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 528.15 53.64'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%230052ff;%7D%3C/style%3E%3C/defs%3E%3Ctitle%3ECoinbase_Wordmark_SubBrands_ALL%3C/title%3E%3Cpath class='cls-1' d='M164.45,15a15,15,0,0,0-11.74,5.4V0h-8.64V52.92h8.5V48a15,15,0,0,0,11.88,5.62c10.37,0,18.21-8.21,18.21-19.3S174.67,15,164.45,15Zm-1.3,30.67c-6.19,0-10.73-4.83-10.73-11.31S157,23,163.22,23s10.66,4.82,10.66,11.37S169.34,45.65,163.15,45.65Zm83.31-14.91-6.34-.93c-3-.43-5.18-1.44-5.18-3.82,0-2.59,2.8-3.89,6.62-3.89,4.18,0,6.84,1.8,7.42,4.76h8.35c-.94-7.49-6.7-11.88-15.55-11.88-9.15,0-15.2,4.68-15.2,11.3,0,6.34,4,10,12,11.16l6.33.94c3.1.43,4.83,1.65,4.83,4,0,2.95-3,4.17-7.2,4.17-5.12,0-8-2.09-8.43-5.25h-8.49c.79,7.27,6.48,12.38,16.84,12.38,9.44,0,15.7-4.32,15.7-11.74C258.12,35.28,253.58,31.82,246.46,30.74Zm-27.65-2.3c0-8.06-4.9-13.46-15.27-13.46-9.79,0-15.26,5-16.34,12.6h8.57c.43-3,2.73-5.4,7.63-5.4,4.39,0,6.55,1.94,6.55,4.32,0,3.09-4,3.88-8.85,4.39-6.63.72-14.84,3-14.84,11.66,0,6.7,5,11,12.89,11,6.19,0,10.08-2.59,12-6.7.28,3.67,3,6.05,6.84,6.05h5v-7.7h-4.25Zm-8.5,9.36c0,5-4.32,8.64-9.57,8.64-3.24,0-6-1.37-6-4.25,0-3.67,4.39-4.68,8.42-5.11s6-1.22,7.13-2.88ZM281.09,15c-11.09,0-19.23,8.35-19.23,19.36,0,11.6,8.72,19.3,19.37,19.3,9,0,16.06-5.33,17.86-12.89h-9c-1.3,3.31-4.47,5.19-8.71,5.19-5.55,0-9.72-3.46-10.66-9.51H299.3V33.12C299.3,22.46,291.53,15,281.09,15Zm-9.87,15.26c1.37-5.18,5.26-7.7,9.72-7.7,4.9,0,8.64,2.8,9.51,7.7ZM19.3,23a9.84,9.84,0,0,1,9.5,7h9.14c-1.65-8.93-9-15-18.57-15A19,19,0,0,0,0,34.34c0,11.09,8.28,19.3,19.37,19.3,9.36,0,16.85-6,18.5-15H28.8a9.75,9.75,0,0,1-9.43,7.06c-6.27,0-10.66-4.83-10.66-11.31S13,23,19.3,23Zm41.11-8A19,19,0,0,0,41,34.34c0,11.09,8.28,19.3,19.37,19.3A19,19,0,0,0,79.92,34.27C79.92,23.33,71.64,15,60.41,15Zm.07,30.67c-6.19,0-10.73-4.83-10.73-11.31S54.22,23,60.41,23s10.8,4.89,10.8,11.37S66.67,45.65,60.48,45.65ZM123.41,15c-5.62,0-9.29,2.3-11.45,5.54V15.7h-8.57V52.92H112V32.69C112,27,115.63,23,121,23c5,0,8.06,3.53,8.06,8.64V52.92h8.64V31C137.66,21.6,132.84,15,123.41,15ZM92,.36a5.36,5.36,0,0,0-5.55,5.47,5.55,5.55,0,0,0,11.09,0A5.35,5.35,0,0,0,92,.36Zm-9.72,23h5.4V52.92h8.64V15.7h-14Zm298.17-7.7L366.2,52.92H372L375.29,44H392l3.33,8.88h6L386.87,15.7ZM377,39.23l6.45-17.56h.1l6.56,17.56ZM362.66,15.7l-7.88,29h-.11l-8.14-29H341l-8,28.93h-.1l-8-28.87H319L329.82,53h5.45l8.19-29.24h.11L352,53h5.66L368.1,15.7Zm135.25,0v4.86h12.32V52.92h5.6V20.56h12.32V15.7ZM467.82,52.92h25.54V48.06H473.43v-12h18.35V31.35H473.43V20.56h19.93V15.7H467.82ZM443,15.7h-5.6V52.92h24.32V48.06H443Zm-30.45,0h-5.61V52.92h24.32V48.06H412.52Z'/%3E%3C/svg%3E`;case"textWithLogo":return n=(.25*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 308.44 77.61'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%230052ff;%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M142.94,20.2l-7.88,29H135l-8.15-29h-5.55l-8,28.93h-.11l-8-28.87H99.27l10.84,37.27h5.44l8.2-29.24h.1l8.41,29.24h5.66L148.39,20.2Zm17.82,0L146.48,57.42h5.82l3.28-8.88h16.65l3.34,8.88h6L167.16,20.2Zm-3.44,23.52,6.45-17.55h.11l6.56,17.55ZM278.2,20.2v4.86h12.32V57.42h5.6V25.06h12.32V20.2ZM248.11,57.42h25.54V52.55H253.71V40.61h18.35V35.85H253.71V25.06h19.94V20.2H248.11ZM223.26,20.2h-5.61V57.42H242V52.55H223.26Zm-30.46,0h-5.6V57.42h24.32V52.55H192.8Zm-154,38A19.41,19.41,0,1,1,57.92,35.57H77.47a38.81,38.81,0,1,0,0,6.47H57.92A19.39,19.39,0,0,1,38.81,58.21Z'/%3E%3C/svg%3E`;case"textLight":return n=(.1*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 528.15 53.64'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fefefe;%7D%3C/style%3E%3C/defs%3E%3Ctitle%3ECoinbase_Wordmark_SubBrands_ALL%3C/title%3E%3Cpath class='cls-1' d='M164.45,15a15,15,0,0,0-11.74,5.4V0h-8.64V52.92h8.5V48a15,15,0,0,0,11.88,5.62c10.37,0,18.21-8.21,18.21-19.3S174.67,15,164.45,15Zm-1.3,30.67c-6.19,0-10.73-4.83-10.73-11.31S157,23,163.22,23s10.66,4.82,10.66,11.37S169.34,45.65,163.15,45.65Zm83.31-14.91-6.34-.93c-3-.43-5.18-1.44-5.18-3.82,0-2.59,2.8-3.89,6.62-3.89,4.18,0,6.84,1.8,7.42,4.76h8.35c-.94-7.49-6.7-11.88-15.55-11.88-9.15,0-15.2,4.68-15.2,11.3,0,6.34,4,10,12,11.16l6.33.94c3.1.43,4.83,1.65,4.83,4,0,2.95-3,4.17-7.2,4.17-5.12,0-8-2.09-8.43-5.25h-8.49c.79,7.27,6.48,12.38,16.84,12.38,9.44,0,15.7-4.32,15.7-11.74C258.12,35.28,253.58,31.82,246.46,30.74Zm-27.65-2.3c0-8.06-4.9-13.46-15.27-13.46-9.79,0-15.26,5-16.34,12.6h8.57c.43-3,2.73-5.4,7.63-5.4,4.39,0,6.55,1.94,6.55,4.32,0,3.09-4,3.88-8.85,4.39-6.63.72-14.84,3-14.84,11.66,0,6.7,5,11,12.89,11,6.19,0,10.08-2.59,12-6.7.28,3.67,3,6.05,6.84,6.05h5v-7.7h-4.25Zm-8.5,9.36c0,5-4.32,8.64-9.57,8.64-3.24,0-6-1.37-6-4.25,0-3.67,4.39-4.68,8.42-5.11s6-1.22,7.13-2.88ZM281.09,15c-11.09,0-19.23,8.35-19.23,19.36,0,11.6,8.72,19.3,19.37,19.3,9,0,16.06-5.33,17.86-12.89h-9c-1.3,3.31-4.47,5.19-8.71,5.19-5.55,0-9.72-3.46-10.66-9.51H299.3V33.12C299.3,22.46,291.53,15,281.09,15Zm-9.87,15.26c1.37-5.18,5.26-7.7,9.72-7.7,4.9,0,8.64,2.8,9.51,7.7ZM19.3,23a9.84,9.84,0,0,1,9.5,7h9.14c-1.65-8.93-9-15-18.57-15A19,19,0,0,0,0,34.34c0,11.09,8.28,19.3,19.37,19.3,9.36,0,16.85-6,18.5-15H28.8a9.75,9.75,0,0,1-9.43,7.06c-6.27,0-10.66-4.83-10.66-11.31S13,23,19.3,23Zm41.11-8A19,19,0,0,0,41,34.34c0,11.09,8.28,19.3,19.37,19.3A19,19,0,0,0,79.92,34.27C79.92,23.33,71.64,15,60.41,15Zm.07,30.67c-6.19,0-10.73-4.83-10.73-11.31S54.22,23,60.41,23s10.8,4.89,10.8,11.37S66.67,45.65,60.48,45.65ZM123.41,15c-5.62,0-9.29,2.3-11.45,5.54V15.7h-8.57V52.92H112V32.69C112,27,115.63,23,121,23c5,0,8.06,3.53,8.06,8.64V52.92h8.64V31C137.66,21.6,132.84,15,123.41,15ZM92,.36a5.36,5.36,0,0,0-5.55,5.47,5.55,5.55,0,0,0,11.09,0A5.35,5.35,0,0,0,92,.36Zm-9.72,23h5.4V52.92h8.64V15.7h-14Zm298.17-7.7L366.2,52.92H372L375.29,44H392l3.33,8.88h6L386.87,15.7ZM377,39.23l6.45-17.56h.1l6.56,17.56ZM362.66,15.7l-7.88,29h-.11l-8.14-29H341l-8,28.93h-.1l-8-28.87H319L329.82,53h5.45l8.19-29.24h.11L352,53h5.66L368.1,15.7Zm135.25,0v4.86h12.32V52.92h5.6V20.56h12.32V15.7ZM467.82,52.92h25.54V48.06H473.43v-12h18.35V31.35H473.43V20.56h19.93V15.7H467.82ZM443,15.7h-5.6V52.92h24.32V48.06H443Zm-30.45,0h-5.61V52.92h24.32V48.06H412.52Z'/%3E%3C/svg%3E`;case"textWithLogoLight":return n=(.25*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 308.44 77.61'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fefefe;%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M142.94,20.2l-7.88,29H135l-8.15-29h-5.55l-8,28.93h-.11l-8-28.87H99.27l10.84,37.27h5.44l8.2-29.24h.1l8.41,29.24h5.66L148.39,20.2Zm17.82,0L146.48,57.42h5.82l3.28-8.88h16.65l3.34,8.88h6L167.16,20.2Zm-3.44,23.52,6.45-17.55h.11l6.56,17.55ZM278.2,20.2v4.86h12.32V57.42h5.6V25.06h12.32V20.2ZM248.11,57.42h25.54V52.55H253.71V40.61h18.35V35.85H253.71V25.06h19.94V20.2H248.11ZM223.26,20.2h-5.61V57.42H242V52.55H223.26Zm-30.46,0h-5.6V57.42h24.32V52.55H192.8Zm-154,38A19.41,19.41,0,1,1,57.92,35.57H77.47a38.81,38.81,0,1,0,0,6.47H57.92A19.39,19.39,0,0,1,38.81,58.21Z'/%3E%3C/svg%3E`;default:return n=e,`data:image/svg+xml,%3Csvg width='${e}' height='${n}' viewBox='0 0 1024 1024' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Crect width='1024' height='1024' fill='%230052FF'/%3E %3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 512C152 710.823 313.177 872 512 872C710.823 872 872 710.823 872 512C872 313.177 710.823 152 512 152C313.177 152 152 313.177 152 512ZM420 396C406.745 396 396 406.745 396 420V604C396 617.255 406.745 628 420 628H604C617.255 628 628 617.255 628 604V420C628 406.745 617.255 396 604 396H420Z' fill='white'/%3E %3C/svg%3E `}};class K{constructor(e,n){this.scope=e,this.module=n}storeObject(e,n){this.setItem(e,JSON.stringify(n))}loadObject(e){const n=this.getItem(e);return n?JSON.parse(n):void 0}setItem(e,n){localStorage.setItem(this.scopedKey(e),n)}getItem(e){return localStorage.getItem(this.scopedKey(e))}removeItem(e){localStorage.removeItem(this.scopedKey(e))}clear(){const e=this.scopedKey(""),n=[];for(let s=0;s<localStorage.length;s++){const i=localStorage.key(s);typeof i=="string"&&i.startsWith(e)&&n.push(i)}n.forEach(s=>localStorage.removeItem(s))}scopedKey(e){return`-${this.scope}${this.module?`:${this.module}`:""}:${e}`}static clearAll(){new K("CBWSDK").clear(),new K("walletlink").clear()}}const U={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901,unsupportedChain:4902}},Te={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4902:{standard:"EIP-3085",message:"Unrecognized chain ID."}},jt="Unspecified error message.",Pn="Unspecified server error.";function Ve(t,e=jt){if(t&&Number.isInteger(t)){const n=t.toString();if(Ne(Te,n))return Te[n].message;if(Ht(t))return Pn}return e}function Rn(t){if(!Number.isInteger(t))return!1;const e=t.toString();return!!(Te[e]||Ht(t))}function Tn(t,{shouldIncludeStack:e=!1}={}){const n={};if(t&&typeof t=="object"&&!Array.isArray(t)&&Ne(t,"code")&&Rn(t.code)){const s=t;n.code=s.code,s.message&&typeof s.message=="string"?(n.message=s.message,Ne(s,"data")&&(n.data=s.data)):(n.message=Ve(n.code),n.data={originalError:tt(t)})}else n.code=U.rpc.internal,n.message=nt(t,"message")?t.message:jt,n.data={originalError:tt(t)};return e&&(n.stack=nt(t,"stack")?t.stack:void 0),n}function Ht(t){return t>=-32099&&t<=-32e3}function tt(t){return t&&typeof t=="object"&&!Array.isArray(t)?Object.assign({},t):t}function Ne(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nt(t,e){return typeof t=="object"&&t!==null&&e in t&&typeof t[e]=="string"}const P={rpc:{parse:t=>V(U.rpc.parse,t),invalidRequest:t=>V(U.rpc.invalidRequest,t),invalidParams:t=>V(U.rpc.invalidParams,t),methodNotFound:t=>V(U.rpc.methodNotFound,t),internal:t=>V(U.rpc.internal,t),server:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:e}=t;if(!Number.isInteger(e)||e>-32005||e<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return V(e,t)},invalidInput:t=>V(U.rpc.invalidInput,t),resourceNotFound:t=>V(U.rpc.resourceNotFound,t),resourceUnavailable:t=>V(U.rpc.resourceUnavailable,t),transactionRejected:t=>V(U.rpc.transactionRejected,t),methodNotSupported:t=>V(U.rpc.methodNotSupported,t),limitExceeded:t=>V(U.rpc.limitExceeded,t)},provider:{userRejectedRequest:t=>te(U.provider.userRejectedRequest,t),unauthorized:t=>te(U.provider.unauthorized,t),unsupportedMethod:t=>te(U.provider.unsupportedMethod,t),disconnected:t=>te(U.provider.disconnected,t),chainDisconnected:t=>te(U.provider.chainDisconnected,t),unsupportedChain:t=>te(U.provider.unsupportedChain,t),custom:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:e,message:n,data:s}=t;if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string');return new qt(e,n,s)}}};function V(t,e){const[n,s]=Bt(e);return new Wt(t,n||Ve(t),s)}function te(t,e){const[n,s]=Bt(e);return new qt(t,n||Ve(t),s)}function Bt(t){if(t){if(typeof t=="string")return[t];if(typeof t=="object"&&!Array.isArray(t)){const{message:e,data:n}=t;if(e&&typeof e!="string")throw new Error("Must specify string message.");return[e||void 0,n]}}return[]}class Wt extends Error{constructor(e,n,s){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string.');super(n),this.code=e,s!==void 0&&(this.data=s)}}class qt extends Wt{constructor(e,n,s){if(!Nn(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,n,s)}}function Nn(t){return Number.isInteger(t)&&t>=1e3&&t<=4999}function Ke(){return t=>t}const de=Ke(),On=Ke(),Dn=Ke();function z(t){return Math.floor(t)}const Vt=/^[0-9]*$/,Kt=/^[a-f0-9]*$/;function X(t){return Fe(crypto.getRandomValues(new Uint8Array(t)))}function Fe(t){return[...t].map(e=>e.toString(16).padStart(2,"0")).join("")}function pe(t){return new Uint8Array(t.match(/.{1,2}/g).map(e=>Number.parseInt(e,16)))}function ae(t,e=!1){const n=t.toString("hex");return de(e?`0x${n}`:n)}function Ce(t){return ae(Oe(t),!0)}function F(t){return Dn(t.toString(10))}function Q(t){return de(`0x${BigInt(t).toString(16)}`)}function Ft(t){return t.startsWith("0x")||t.startsWith("0X")}function ze(t){return Ft(t)?t.slice(2):t}function zt(t){return Ft(t)?`0x${t.slice(2)}`:`0x${t}`}function be(t){if(typeof t!="string")return!1;const e=ze(t).toLowerCase();return Kt.test(e)}function Un(t,e=!1){if(typeof t=="string"){const n=ze(t).toLowerCase();if(Kt.test(n))return de(e?`0x${n}`:n)}throw P.rpc.invalidParams(`"${String(t)}" is not a hexadecimal string`)}function $e(t,e=!1){let n=Un(t,!1);return n.length%2===1&&(n=de(`0${n}`)),e?de(`0x${n}`):n}function Y(t){if(typeof t=="string"){const e=ze(t).toLowerCase();if(be(e)&&e.length===40)return On(zt(e))}throw P.rpc.invalidParams(`Invalid Ethereum address: ${String(t)}`)}function Oe(t){if(Buffer.isBuffer(t))return t;if(typeof t=="string"){if(be(t)){const e=$e(t,!1);return Buffer.from(e,"hex")}return Buffer.from(t,"utf8")}throw P.rpc.invalidParams(`Not binary data: ${String(t)}`)}function ce(t){if(typeof t=="number"&&Number.isInteger(t))return z(t);if(typeof t=="string"){if(Vt.test(t))return z(Number(t));if(be(t))return z(Number(BigInt($e(t,!0))))}throw P.rpc.invalidParams(`Not an integer: ${String(t)}`)}function ie(t){if(t!==null&&(typeof t=="bigint"||Hn(t)))return BigInt(t.toString(10));if(typeof t=="number")return BigInt(ce(t));if(typeof t=="string"){if(Vt.test(t))return BigInt(t);if(be(t))return BigInt($e(t,!0))}throw P.rpc.invalidParams(`Not an integer: ${String(t)}`)}function jn(t){if(typeof t=="string")return JSON.parse(t);if(typeof t=="object")return t;throw P.rpc.invalidParams(`Not a JSON string or an object: ${String(t)}`)}function Hn(t){if(t==null||typeof t.constructor!="function")return!1;const{constructor:e}=t;return typeof e.config=="function"&&typeof e.EUCLID=="number"}function Bn(){const t=document.querySelector('link[sizes="192x192"]')||document.querySelector('link[sizes="180x180"]')||document.querySelector('link[rel="icon"]')||document.querySelector('link[rel="shortcut icon"]'),{protocol:e,host:n}=document.location,s=t?t.getAttribute("href"):null;return!s||s.startsWith("javascript:")||s.startsWith("vbscript:")?`${e}//${n}/favicon.ico`:s.startsWith("http://")||s.startsWith("https://")||s.startsWith("data:")?s:s.startsWith("//")?e+s:`${e}//${n}${s}`}async function Wn(){return crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"])}async function qn(t,e){return crypto.subtle.deriveKey({name:"ECDH",public:e},t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function Vn(t,e){const n=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,new TextEncoder().encode(e));return{iv:n,cipherText:s}}async function Kn(t,{iv:e,cipherText:n}){const s=await crypto.subtle.decrypt({name:"AES-GCM",iv:e},t,n);return new TextDecoder().decode(s)}function $t(t){switch(t){case"public":return"spki";case"private":return"pkcs8"}}async function Zt(t,e){const n=$t(t),s=await crypto.subtle.exportKey(n,e);return Fe(new Uint8Array(s))}async function Gt(t,e){const n=$t(t),s=pe(e).buffer;return await crypto.subtle.importKey(n,new Uint8Array(s),{name:"ECDH",namedCurve:"P-256"},!0,t==="private"?["deriveKey"]:[])}async function Fn(t,e){const n=JSON.stringify(t,(s,i)=>{if(!(i instanceof Error))return i;const r=i;return Object.assign(Object.assign({},r.code?{code:r.code}:{}),{message:r.message})});return Vn(e,n)}async function zn(t,e){return JSON.parse(await Kn(e,t))}const Se={storageKey:"ownPrivateKey",keyType:"private"},Ie={storageKey:"ownPublicKey",keyType:"public"},Le={storageKey:"peerPublicKey",keyType:"public"};class $n{constructor(){this.storage=new K("CBWSDK","SCWKeyManager"),this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null}async getOwnPublicKey(){return await this.loadKeysIfNeeded(),this.ownPublicKey}async getSharedSecret(){return await this.loadKeysIfNeeded(),this.sharedSecret}async setPeerPublicKey(e){this.sharedSecret=null,this.peerPublicKey=e,await this.storeKey(Le,e),await this.loadKeysIfNeeded()}async clear(){this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null,this.storage.removeItem(Ie.storageKey),this.storage.removeItem(Se.storageKey),this.storage.removeItem(Le.storageKey)}async generateKeyPair(){const e=await Wn();this.ownPrivateKey=e.privateKey,this.ownPublicKey=e.publicKey,await this.storeKey(Se,e.privateKey),await this.storeKey(Ie,e.publicKey)}async loadKeysIfNeeded(){if(this.ownPrivateKey===null&&(this.ownPrivateKey=await this.loadKey(Se)),this.ownPublicKey===null&&(this.ownPublicKey=await this.loadKey(Ie)),(this.ownPrivateKey===null||this.ownPublicKey===null)&&await this.generateKeyPair(),this.peerPublicKey===null&&(this.peerPublicKey=await this.loadKey(Le)),this.sharedSecret===null){if(this.ownPrivateKey===null||this.peerPublicKey===null)return;this.sharedSecret=await qn(this.ownPrivateKey,this.peerPublicKey)}}async loadKey(e){const n=this.storage.getItem(e.storageKey);return n?Gt(e.keyType,n):null}async storeKey(e,n){const s=await Zt(e.keyType,n);this.storage.setItem(e.storageKey,s)}}const re="4.3.0",Yt="@coinbase/wallet-sdk";async function Ze(t,e){const n=Object.assign(Object.assign({},t),{jsonrpc:"2.0",id:crypto.randomUUID()}),s=await window.fetch(e,{method:"POST",body:JSON.stringify(n),mode:"cors",headers:{"Content-Type":"application/json","X-Cbw-Sdk-Version":re,"X-Cbw-Sdk-Platform":Yt}}),{result:i,error:r}=await s.json();if(r)throw r;return i}function Zn(){return globalThis.coinbaseWalletExtension}function Gn(){var t,e;try{const n=globalThis;return(t=n.ethereum)!==null&&t!==void 0?t:(e=n.top)===null||e===void 0?void 0:e.ethereum}catch{return}}function Jt({metadata:t,preference:e}){var n,s;const{appName:i,appLogoUrl:r,appChainIds:o}=t;if(e.options!=="smartWalletOnly"){const h=Zn();if(h)return(n=h.setAppInfo)===null||n===void 0||n.call(h,i,r,o,e),h}const a=Gn();if(a?.isCoinbaseBrowser)return(s=a.setAppInfo)===null||s===void 0||s.call(a,i,r,o,e),a}function Yn(t){if(!t||typeof t!="object"||Array.isArray(t))throw P.rpc.invalidParams({message:"Expected a single, non-array, object argument.",data:t});const{method:e,params:n}=t;if(typeof e!="string"||e.length===0)throw P.rpc.invalidParams({message:"'args.method' must be a non-empty string.",data:t});if(n!==void 0&&!Array.isArray(n)&&(typeof n!="object"||n===null))throw P.rpc.invalidParams({message:"'args.params' must be an object or array if provided.",data:t});switch(e){case"eth_sign":case"eth_signTypedData_v2":case"eth_subscribe":case"eth_unsubscribe":throw P.provider.unsupportedMethod()}}const st="accounts",rt="activeChain",it="availableChains",ot="walletCapabilities";class Jn{constructor(e){var n,s,i;this.metadata=e.metadata,this.communicator=e.communicator,this.callback=e.callback,this.keyManager=new $n,this.storage=new K("CBWSDK","SCWStateManager"),this.accounts=(n=this.storage.loadObject(st))!==null&&n!==void 0?n:[],this.chain=this.storage.loadObject(rt)||{id:(i=(s=e.metadata.appChainIds)===null||s===void 0?void 0:s[0])!==null&&i!==void 0?i:1},this.handshake=this.handshake.bind(this),this.request=this.request.bind(this),this.createRequestMessage=this.createRequestMessage.bind(this),this.decryptResponseMessage=this.decryptResponseMessage.bind(this)}async handshake(e){var n,s,i,r;await((s=(n=this.communicator).waitForPopupLoaded)===null||s===void 0?void 0:s.call(n));const o=await this.createRequestMessage({handshake:{method:e.method,params:Object.assign({},this.metadata,(i=e.params)!==null&&i!==void 0?i:{})}}),a=await this.communicator.postRequestAndWaitForResponse(o);if("failure"in a.content)throw a.content.failure;const h=await Gt("public",a.sender);await this.keyManager.setPeerPublicKey(h);const g=(await this.decryptResponseMessage(a)).result;if("error"in g)throw g.error;switch(e.method){case"eth_requestAccounts":{const l=g.value;this.accounts=l,this.storage.storeObject(st,l),(r=this.callback)===null||r===void 0||r.call(this,"accountsChanged",l);break}}}async request(e){var n;if(this.accounts.length===0)switch(e.method){case"wallet_sendCalls":return this.sendRequestToPopup(e);default:throw P.provider.unauthorized()}switch(e.method){case"eth_requestAccounts":return(n=this.callback)===null||n===void 0||n.call(this,"connect",{chainId:Q(this.chain.id)}),this.accounts;case"eth_accounts":return this.accounts;case"eth_coinbase":return this.accounts[0];case"net_version":return this.chain.id;case"eth_chainId":return Q(this.chain.id);case"wallet_getCapabilities":return this.storage.loadObject(ot);case"wallet_switchEthereumChain":return this.handleSwitchChainRequest(e);case"eth_ecRecover":case"personal_sign":case"wallet_sign":case"personal_ecRecover":case"eth_signTransaction":case"eth_sendTransaction":case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"wallet_sendCalls":case"wallet_showCallsStatus":case"wallet_grantPermissions":return this.sendRequestToPopup(e);default:if(!this.chain.rpcUrl)throw P.rpc.internal("No RPC URL set for chain");return Ze(e,this.chain.rpcUrl)}}async sendRequestToPopup(e){var n,s;await((s=(n=this.communicator).waitForPopupLoaded)===null||s===void 0?void 0:s.call(n));const i=await this.sendEncryptedRequest(e),o=(await this.decryptResponseMessage(i)).result;if("error"in o)throw o.error;return o.value}async cleanup(){var e,n;this.storage.clear(),await this.keyManager.clear(),this.accounts=[],this.chain={id:(n=(e=this.metadata.appChainIds)===null||e===void 0?void 0:e[0])!==null&&n!==void 0?n:1}}async handleSwitchChainRequest(e){var n;const s=e.params;if(!s||!(!((n=s[0])===null||n===void 0)&&n.chainId))throw P.rpc.invalidParams();const i=ce(s[0].chainId);if(this.updateChain(i))return null;const o=await this.sendRequestToPopup(e);return o===null&&this.updateChain(i),o}async sendEncryptedRequest(e){const n=await this.keyManager.getSharedSecret();if(!n)throw P.provider.unauthorized("No valid session found, try requestAccounts before other methods");const s=await Fn({action:e,chainId:this.chain.id},n),i=await this.createRequestMessage({encrypted:s});return this.communicator.postRequestAndWaitForResponse(i)}async createRequestMessage(e){const n=await Zt("public",await this.keyManager.getOwnPublicKey());return{id:crypto.randomUUID(),sender:n,content:e,timestamp:new Date}}async decryptResponseMessage(e){var n,s;const i=e.content;if("failure"in i)throw i.failure;const r=await this.keyManager.getSharedSecret();if(!r)throw P.provider.unauthorized("Invalid session");const o=await zn(i.encrypted,r),a=(n=o.data)===null||n===void 0?void 0:n.chains;if(a){const d=Object.entries(a).map(([g,l])=>({id:Number(g),rpcUrl:l}));this.storage.storeObject(it,d),this.updateChain(this.chain.id,d)}const h=(s=o.data)===null||s===void 0?void 0:s.capabilities;return h&&this.storage.storeObject(ot,h),o}updateChain(e,n){var s;const i=n??this.storage.loadObject(it),r=i?.find(o=>o.id===e);return r?(r!==this.chain&&(this.chain=r,this.storage.storeObject(rt,r),(s=this.callback)===null||s===void 0||s.call(this,"chainChanged",Q(r.id))),!0):!1}}var O={},J={},at;function Qt(){if(at)return J;at=1,Object.defineProperty(J,"__esModule",{value:!0}),J.anumber=t,J.abytes=n,J.ahash=s,J.aexists=i,J.aoutput=r;function t(o){if(!Number.isSafeInteger(o)||o<0)throw new Error("positive integer expected, got "+o)}function e(o){return o instanceof Uint8Array||ArrayBuffer.isView(o)&&o.constructor.name==="Uint8Array"}function n(o,...a){if(!e(o))throw new Error("Uint8Array expected");if(a.length>0&&!a.includes(o.length))throw new Error("Uint8Array expected of length "+a+", got length="+o.length)}function s(o){if(typeof o!="function"||typeof o.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");t(o.outputLen),t(o.blockLen)}function i(o,a=!0){if(o.destroyed)throw new Error("Hash instance has been destroyed");if(a&&o.finished)throw new Error("Hash#digest() has already been called")}function r(o,a){n(o);const h=a.outputLen;if(o.length<h)throw new Error("digestInto() expects output buffer of length at least "+h)}return J}var L={},ct;function Qn(){if(ct)return L;ct=1,Object.defineProperty(L,"__esModule",{value:!0}),L.add5L=L.add5H=L.add4H=L.add4L=L.add3H=L.add3L=L.rotlBL=L.rotlBH=L.rotlSL=L.rotlSH=L.rotr32L=L.rotr32H=L.rotrBL=L.rotrBH=L.rotrSL=L.rotrSH=L.shrSL=L.shrSH=L.toBig=void 0,L.fromBig=n,L.split=s,L.add=E;const t=BigInt(2**32-1),e=BigInt(32);function n(y,_=!1){return _?{h:Number(y&t),l:Number(y>>e&t)}:{h:Number(y>>e&t)|0,l:Number(y&t)|0}}function s(y,_=!1){let m=new Uint32Array(y.length),p=new Uint32Array(y.length);for(let v=0;v<y.length;v++){const{h:M,l:N}=n(y[v],_);[m[v],p[v]]=[M,N]}return[m,p]}const i=(y,_)=>BigInt(y>>>0)<<e|BigInt(_>>>0);L.toBig=i;const r=(y,_,m)=>y>>>m;L.shrSH=r;const o=(y,_,m)=>y<<32-m|_>>>m;L.shrSL=o;const a=(y,_,m)=>y>>>m|_<<32-m;L.rotrSH=a;const h=(y,_,m)=>y<<32-m|_>>>m;L.rotrSL=h;const d=(y,_,m)=>y<<64-m|_>>>m-32;L.rotrBH=d;const g=(y,_,m)=>y>>>m-32|_<<64-m;L.rotrBL=g;const l=(y,_)=>_;L.rotr32H=l;const u=(y,_)=>y;L.rotr32L=u;const c=(y,_,m)=>y<<m|_>>>32-m;L.rotlSH=c;const f=(y,_,m)=>_<<m|y>>>32-m;L.rotlSL=f;const S=(y,_,m)=>_<<m-32|y>>>64-m;L.rotlBH=S;const b=(y,_,m)=>y<<m-32|_>>>64-m;L.rotlBL=b;function E(y,_,m,p){const v=(_>>>0)+(p>>>0);return{h:y+m+(v/2**32|0)|0,l:v|0}}const C=(y,_,m)=>(y>>>0)+(_>>>0)+(m>>>0);L.add3L=C;const x=(y,_,m,p)=>_+m+p+(y/2**32|0)|0;L.add3H=x;const k=(y,_,m,p)=>(y>>>0)+(_>>>0)+(m>>>0)+(p>>>0);L.add4L=k;const w=(y,_,m,p,v)=>_+m+p+v+(y/2**32|0)|0;L.add4H=w;const I=(y,_,m,p,v)=>(y>>>0)+(_>>>0)+(m>>>0)+(p>>>0)+(v>>>0);L.add5L=I;const A=(y,_,m,p,v,M)=>_+m+p+v+M+(y/2**32|0)|0;L.add5H=A;const R={fromBig:n,split:s,toBig:i,shrSH:r,shrSL:o,rotrSH:a,rotrSL:h,rotrBH:d,rotrBL:g,rotr32H:l,rotr32L:u,rotlSH:c,rotlSL:f,rotlBH:S,rotlBL:b,add:E,add3L:C,add3H:x,add4L:k,add4H:w,add5H:A,add5L:I};return L.default=R,L}var Ae={},oe={},lt;function Xn(){return lt||(lt=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.crypto=void 0,oe.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0),oe}var dt;function es(){return dt||(dt=1,(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.Hash=t.nextTick=t.byteSwapIfBE=t.isLE=void 0,t.isBytes=s,t.u8=i,t.u32=r,t.createView=o,t.rotr=a,t.rotl=h,t.byteSwap=d,t.byteSwap32=g,t.bytesToHex=c,t.hexToBytes=b,t.asyncLoop=C,t.utf8ToBytes=x,t.toBytes=k,t.concatBytes=w,t.checkOpts=A,t.wrapConstructor=R,t.wrapConstructorWithOpts=y,t.wrapXOFConstructorWithOpts=_,t.randomBytes=m;const e=Xn(),n=Qt();function s(p){return p instanceof Uint8Array||ArrayBuffer.isView(p)&&p.constructor.name==="Uint8Array"}function i(p){return new Uint8Array(p.buffer,p.byteOffset,p.byteLength)}function r(p){return new Uint32Array(p.buffer,p.byteOffset,Math.floor(p.byteLength/4))}function o(p){return new DataView(p.buffer,p.byteOffset,p.byteLength)}function a(p,v){return p<<32-v|p>>>v}function h(p,v){return p<<v|p>>>32-v>>>0}t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function d(p){return p<<24&4278190080|p<<8&16711680|p>>>8&65280|p>>>24&255}t.byteSwapIfBE=t.isLE?p=>p:p=>d(p);function g(p){for(let v=0;v<p.length;v++)p[v]=d(p[v])}const l=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",u=Array.from({length:256},(p,v)=>v.toString(16).padStart(2,"0"));function c(p){if((0,n.abytes)(p),l)return p.toHex();let v="";for(let M=0;M<p.length;M++)v+=u[p[M]];return v}const f={_0:48,_9:57,A:65,F:70,a:97,f:102};function S(p){if(p>=f._0&&p<=f._9)return p-f._0;if(p>=f.A&&p<=f.F)return p-(f.A-10);if(p>=f.a&&p<=f.f)return p-(f.a-10)}function b(p){if(typeof p!="string")throw new Error("hex string expected, got "+typeof p);if(l)return Uint8Array.fromHex(p);const v=p.length,M=v/2;if(v%2)throw new Error("hex string expected, got unpadded hex of length "+v);const N=new Uint8Array(M);for(let B=0,W=0;B<M;B++,W+=2){const Xe=S(p.charCodeAt(W)),et=S(p.charCodeAt(W+1));if(Xe===void 0||et===void 0){const Sn=p[W]+p[W+1];throw new Error('hex string expected, got non-hex character "'+Sn+'" at index '+W)}N[B]=Xe*16+et}return N}const E=async()=>{};t.nextTick=E;async function C(p,v,M){let N=Date.now();for(let B=0;B<p;B++){M(B);const W=Date.now()-N;W>=0&&W<v||(await(0,t.nextTick)(),N+=W)}}function x(p){if(typeof p!="string")throw new Error("utf8ToBytes expected string, got "+typeof p);return new Uint8Array(new TextEncoder().encode(p))}function k(p){return typeof p=="string"&&(p=x(p)),(0,n.abytes)(p),p}function w(...p){let v=0;for(let N=0;N<p.length;N++){const B=p[N];(0,n.abytes)(B),v+=B.length}const M=new Uint8Array(v);for(let N=0,B=0;N<p.length;N++){const W=p[N];M.set(W,B),B+=W.length}return M}class I{clone(){return this._cloneInto()}}t.Hash=I;function A(p,v){if(v!==void 0&&{}.toString.call(v)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(p,v)}function R(p){const v=N=>p().update(k(N)).digest(),M=p();return v.outputLen=M.outputLen,v.blockLen=M.blockLen,v.create=()=>p(),v}function y(p){const v=(N,B)=>p(B).update(k(N)).digest(),M=p({});return v.outputLen=M.outputLen,v.blockLen=M.blockLen,v.create=N=>p(N),v}function _(p){const v=(N,B)=>p(B).update(k(N)).digest(),M=p({});return v.outputLen=M.outputLen,v.blockLen=M.blockLen,v.create=N=>p(N),v}function m(p=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(p));if(e.crypto&&typeof e.crypto.randomBytes=="function")return Uint8Array.from(e.crypto.randomBytes(p));throw new Error("crypto.getRandomValues must be defined")}})(Ae)),Ae}var ut;function ts(){if(ut)return O;ut=1,Object.defineProperty(O,"__esModule",{value:!0}),O.shake256=O.shake128=O.keccak_512=O.keccak_384=O.keccak_256=O.keccak_224=O.sha3_512=O.sha3_384=O.sha3_256=O.sha3_224=O.Keccak=void 0,O.keccakP=b;const t=Qt(),e=Qn(),n=es(),s=[],i=[],r=[],o=BigInt(0),a=BigInt(1),h=BigInt(2),d=BigInt(7),g=BigInt(256),l=BigInt(113);for(let k=0,w=a,I=1,A=0;k<24;k++){[I,A]=[A,(2*I+3*A)%5],s.push(2*(5*A+I)),i.push((k+1)*(k+2)/2%64);let R=o;for(let y=0;y<7;y++)w=(w<<a^(w>>d)*l)%g,w&h&&(R^=a<<(a<<BigInt(y))-a);r.push(R)}const[u,c]=(0,e.split)(r,!0),f=(k,w,I)=>I>32?(0,e.rotlBH)(k,w,I):(0,e.rotlSH)(k,w,I),S=(k,w,I)=>I>32?(0,e.rotlBL)(k,w,I):(0,e.rotlSL)(k,w,I);function b(k,w=24){const I=new Uint32Array(10);for(let A=24-w;A<24;A++){for(let _=0;_<10;_++)I[_]=k[_]^k[_+10]^k[_+20]^k[_+30]^k[_+40];for(let _=0;_<10;_+=2){const m=(_+8)%10,p=(_+2)%10,v=I[p],M=I[p+1],N=f(v,M,1)^I[m],B=S(v,M,1)^I[m+1];for(let W=0;W<50;W+=10)k[_+W]^=N,k[_+W+1]^=B}let R=k[2],y=k[3];for(let _=0;_<24;_++){const m=i[_],p=f(R,y,m),v=S(R,y,m),M=s[_];R=k[M],y=k[M+1],k[M]=p,k[M+1]=v}for(let _=0;_<50;_+=10){for(let m=0;m<10;m++)I[m]=k[_+m];for(let m=0;m<10;m++)k[_+m]^=~I[(m+2)%10]&I[(m+4)%10]}k[0]^=u[A],k[1]^=c[A]}I.fill(0)}class E extends n.Hash{constructor(w,I,A,R=!1,y=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=w,this.suffix=I,this.outputLen=A,this.enableXOF=R,this.rounds=y,(0,t.anumber)(A),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,n.u32)(this.state)}keccak(){n.isLE||(0,n.byteSwap32)(this.state32),b(this.state32,this.rounds),n.isLE||(0,n.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(w){(0,t.aexists)(this);const{blockLen:I,state:A}=this;w=(0,n.toBytes)(w);const R=w.length;for(let y=0;y<R;){const _=Math.min(I-this.pos,R-y);for(let m=0;m<_;m++)A[this.pos++]^=w[y++];this.pos===I&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:w,suffix:I,pos:A,blockLen:R}=this;w[A]^=I,(I&128)!==0&&A===R-1&&this.keccak(),w[R-1]^=128,this.keccak()}writeInto(w){(0,t.aexists)(this,!1),(0,t.abytes)(w),this.finish();const I=this.state,{blockLen:A}=this;for(let R=0,y=w.length;R<y;){this.posOut>=A&&this.keccak();const _=Math.min(A-this.posOut,y-R);w.set(I.subarray(this.posOut,this.posOut+_),R),this.posOut+=_,R+=_}return w}xofInto(w){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(w)}xof(w){return(0,t.anumber)(w),this.xofInto(new Uint8Array(w))}digestInto(w){if((0,t.aoutput)(w,this),this.finished)throw new Error("digest() was already called");return this.writeInto(w),this.destroy(),w}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(w){const{blockLen:I,suffix:A,outputLen:R,rounds:y,enableXOF:_}=this;return w||(w=new E(I,A,R,_,y)),w.state32.set(this.state32),w.pos=this.pos,w.posOut=this.posOut,w.finished=this.finished,w.rounds=y,w.suffix=A,w.outputLen=R,w.enableXOF=_,w.destroyed=this.destroyed,w}}O.Keccak=E;const C=(k,w,I)=>(0,n.wrapConstructor)(()=>new E(w,k,I));O.sha3_224=C(6,144,224/8),O.sha3_256=C(6,136,256/8),O.sha3_384=C(6,104,384/8),O.sha3_512=C(6,72,512/8),O.keccak_224=C(1,144,224/8),O.keccak_256=C(1,136,256/8),O.keccak_384=C(1,104,384/8),O.keccak_512=C(1,72,512/8);const x=(k,w,I)=>(0,n.wrapXOFConstructorWithOpts)((A={})=>new E(w,k,A.dkLen===void 0?I:A.dkLen,!0));return O.shake128=x(31,168,128/8),O.shake256=x(31,136,256/8),O}var xe,ht;function Xt(){if(ht)return xe;ht=1;const{keccak_256:t}=ts();function e(c){return Buffer.allocUnsafe(c).fill(0)}function n(c){return c.toString(2).length}function s(c,f){let S=c.toString(16);S.length%2!==0&&(S="0"+S);const b=S.match(/.{1,2}/g).map(E=>parseInt(E,16));for(;b.length<f;)b.unshift(0);return Buffer.from(b)}function i(c,f){const S=c<0n;let b;if(S){const E=(1n<<BigInt(f))-1n;b=(~c&E)+1n}else b=c;return b&=(1n<<BigInt(f))-1n,b}function r(c,f,S){const b=e(f);return c=a(c),S?c.length<f?(c.copy(b),b):c.slice(0,f):c.length<f?(c.copy(b,f-c.length),b):c.slice(-f)}function o(c,f){return r(c,f,!0)}function a(c){if(!Buffer.isBuffer(c))if(Array.isArray(c))c=Buffer.from(c);else if(typeof c=="string")l(c)?c=Buffer.from(g(u(c)),"hex"):c=Buffer.from(c);else if(typeof c=="number")c=intToBuffer(c);else if(c==null)c=Buffer.allocUnsafe(0);else if(typeof c=="bigint")c=s(c);else if(c.toArray)c=Buffer.from(c.toArray());else throw new Error("invalid type");return c}function h(c){return c=a(c),"0x"+c.toString("hex")}function d(c,f){if(c=a(c),f||(f=256),f!==256)throw new Error("unsupported");return Buffer.from(t(new Uint8Array(c)))}function g(c){return c.length%2?"0"+c:c}function l(c){return typeof c=="string"&&c.match(/^0x[0-9A-Fa-f]*$/)}function u(c){return typeof c=="string"&&c.startsWith("0x")?c.slice(2):c}return xe={zeros:e,setLength:r,setLengthRight:o,isHexString:l,stripHexPrefix:u,toBuffer:a,bufferToHex:h,keccak:d,bitLengthFromBigInt:n,bufferBEFromBigInt:s,twosFromBigInt:i},xe}var Me,ft;function ns(){if(ft)return Me;ft=1;const t=Xt();function e(u){return u.startsWith("int[")?"int256"+u.slice(3):u==="int"?"int256":u.startsWith("uint[")?"uint256"+u.slice(4):u==="uint"?"uint256":u.startsWith("fixed[")?"fixed128x128"+u.slice(5):u==="fixed"?"fixed128x128":u.startsWith("ufixed[")?"ufixed128x128"+u.slice(6):u==="ufixed"?"ufixed128x128":u}function n(u){return Number.parseInt(/^\D+(\d+)$/.exec(u)[1],10)}function s(u){var c=/^\D+(\d+)x(\d+)$/.exec(u);return[Number.parseInt(c[1],10),Number.parseInt(c[2],10)]}function i(u){var c=u.match(/(.*)\[(.*?)\]$/);return c?c[2]===""?"dynamic":Number.parseInt(c[2],10):null}function r(u){var c=typeof u;if(c==="string"||c==="number")return BigInt(u);if(c==="bigint")return u;throw new Error("Argument is not a number")}function o(u,c){var f,S,b,E;if(u==="address")return o("uint160",r(c));if(u==="bool")return o("uint8",c?1:0);if(u==="string")return o("bytes",new Buffer(c,"utf8"));if(h(u)){if(typeof c.length>"u")throw new Error("Not an array?");if(f=i(u),f!=="dynamic"&&f!==0&&c.length>f)throw new Error("Elements exceed array size: "+f);b=[],u=u.slice(0,u.lastIndexOf("[")),typeof c=="string"&&(c=JSON.parse(c));for(E in c)b.push(o(u,c[E]));if(f==="dynamic"){var C=o("uint256",c.length);b.unshift(C)}return Buffer.concat(b)}else{if(u==="bytes")return c=new Buffer(c),b=Buffer.concat([o("uint256",c.length),c]),c.length%32!==0&&(b=Buffer.concat([b,t.zeros(32-c.length%32)])),b;if(u.startsWith("bytes")){if(f=n(u),f<1||f>32)throw new Error("Invalid bytes<N> width: "+f);return t.setLengthRight(c,32)}else if(u.startsWith("uint")){if(f=n(u),f%8||f<8||f>256)throw new Error("Invalid uint<N> width: "+f);S=r(c);const x=t.bitLengthFromBigInt(S);if(x>f)throw new Error("Supplied uint exceeds width: "+f+" vs "+x);if(S<0)throw new Error("Supplied uint is negative");return t.bufferBEFromBigInt(S,32)}else if(u.startsWith("int")){if(f=n(u),f%8||f<8||f>256)throw new Error("Invalid int<N> width: "+f);S=r(c);const x=t.bitLengthFromBigInt(S);if(x>f)throw new Error("Supplied int exceeds width: "+f+" vs "+x);const k=t.twosFromBigInt(S,256);return t.bufferBEFromBigInt(k,32)}else if(u.startsWith("ufixed")){if(f=s(u),S=r(c),S<0)throw new Error("Supplied ufixed is negative");return o("uint256",S*BigInt(2)**BigInt(f[1]))}else if(u.startsWith("fixed"))return f=s(u),o("int256",r(c)*BigInt(2)**BigInt(f[1]))}throw new Error("Unsupported or invalid type: "+u)}function a(u){return u==="string"||u==="bytes"||i(u)==="dynamic"}function h(u){return u.lastIndexOf("]")===u.length-1}function d(u,c){var f=[],S=[],b=32*u.length;for(var E in u){var C=e(u[E]),x=c[E],k=o(C,x);a(C)?(f.push(o("uint256",b)),S.push(k),b+=k.length):f.push(k)}return Buffer.concat(f.concat(S))}function g(u,c){if(u.length!==c.length)throw new Error("Number of types are not matching the values");for(var f,S,b=[],E=0;E<u.length;E++){var C=e(u[E]),x=c[E];if(C==="bytes")b.push(x);else if(C==="string")b.push(new Buffer(x,"utf8"));else if(C==="bool")b.push(new Buffer(x?"01":"00","hex"));else if(C==="address")b.push(t.setLength(x,20));else if(C.startsWith("bytes")){if(f=n(C),f<1||f>32)throw new Error("Invalid bytes<N> width: "+f);b.push(t.setLengthRight(x,f))}else if(C.startsWith("uint")){if(f=n(C),f%8||f<8||f>256)throw new Error("Invalid uint<N> width: "+f);S=r(x);const k=t.bitLengthFromBigInt(S);if(k>f)throw new Error("Supplied uint exceeds width: "+f+" vs "+k);b.push(t.bufferBEFromBigInt(S,f/8))}else if(C.startsWith("int")){if(f=n(C),f%8||f<8||f>256)throw new Error("Invalid int<N> width: "+f);S=r(x);const k=t.bitLengthFromBigInt(S);if(k>f)throw new Error("Supplied int exceeds width: "+f+" vs "+k);const w=t.twosFromBigInt(S,f);b.push(t.bufferBEFromBigInt(w,f/8))}else throw new Error("Unsupported or invalid type: "+C)}return Buffer.concat(b)}function l(u,c){return t.keccak(g(u,c))}return Me={rawEncode:d,solidityPack:g,soliditySHA3:l},Me}var Pe,pt;function ss(){if(pt)return Pe;pt=1;const t=Xt(),e=ns(),n={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},s={encodeData(r,o,a,h=!0){const d=["bytes32"],g=[this.hashType(r,a)];if(h){const l=(u,c,f)=>{if(a[c]!==void 0)return["bytes32",f==null?"0x0000000000000000000000000000000000000000000000000000000000000000":t.keccak(this.encodeData(c,f,a,h))];if(f===void 0)throw new Error(`missing value for field ${u} of type ${c}`);if(c==="bytes")return["bytes32",t.keccak(f)];if(c==="string")return typeof f=="string"&&(f=Buffer.from(f,"utf8")),["bytes32",t.keccak(f)];if(c.lastIndexOf("]")===c.length-1){const S=c.slice(0,c.lastIndexOf("[")),b=f.map(E=>l(u,S,E));return["bytes32",t.keccak(e.rawEncode(b.map(([E])=>E),b.map(([,E])=>E)))]}return[c,f]};for(const u of a[r]){const[c,f]=l(u.name,u.type,o[u.name]);d.push(c),g.push(f)}}else for(const l of a[r]){let u=o[l.name];if(u!==void 0)if(l.type==="bytes")d.push("bytes32"),u=t.keccak(u),g.push(u);else if(l.type==="string")d.push("bytes32"),typeof u=="string"&&(u=Buffer.from(u,"utf8")),u=t.keccak(u),g.push(u);else if(a[l.type]!==void 0)d.push("bytes32"),u=t.keccak(this.encodeData(l.type,u,a,h)),g.push(u);else{if(l.type.lastIndexOf("]")===l.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");d.push(l.type),g.push(u)}}return e.rawEncode(d,g)},encodeType(r,o){let a="",h=this.findTypeDependencies(r,o).filter(d=>d!==r);h=[r].concat(h.sort());for(const d of h){if(!o[d])throw new Error("No type definition specified: "+d);a+=d+"("+o[d].map(({name:l,type:u})=>u+" "+l).join(",")+")"}return a},findTypeDependencies(r,o,a=[]){if(r=r.match(/^\w*/)[0],a.includes(r)||o[r]===void 0)return a;a.push(r);for(const h of o[r])for(const d of this.findTypeDependencies(h.type,o,a))!a.includes(d)&&a.push(d);return a},hashStruct(r,o,a,h=!0){return t.keccak(this.encodeData(r,o,a,h))},hashType(r,o){return t.keccak(this.encodeType(r,o))},sanitizeData(r){const o={};for(const a in n.properties)r[a]&&(o[a]=r[a]);return o.types&&(o.types=Object.assign({EIP712Domain:[]},o.types)),o},hash(r,o=!0){const a=this.sanitizeData(r),h=[Buffer.from("1901","hex")];return h.push(this.hashStruct("EIP712Domain",a.domain,a.types,o)),a.primaryType!=="EIP712Domain"&&h.push(this.hashStruct(a.primaryType,a.message,a.types,o)),t.keccak(Buffer.concat(h))}};Pe={TYPED_MESSAGE_SCHEMA:n,TypedDataUtils:s,hashForSignTypedDataLegacy:function(r){return i(r.data)},hashForSignTypedData_v3:function(r){return s.hash(r.data,!1)},hashForSignTypedData_v4:function(r){return s.hash(r.data)}};function i(r){const o=new Error("Expect argument to be non-empty array");if(typeof r!="object"||!r.length)throw o;const a=r.map(function(g){return g.type==="bytes"?t.toBuffer(g.value):g.value}),h=r.map(function(g){return g.type}),d=r.map(function(g){if(!g.name)throw o;return g.type+" "+g.name});return e.soliditySHA3(["bytes32","bytes32"],[e.soliditySHA3(new Array(r.length).fill("string"),d),e.soliditySHA3(h,a)])}return Pe}var rs=ss();const he=In(rs),is="walletUsername",De="Addresses",os="AppVersion";function q(t){return t.errorMessage!==void 0}class as{constructor(e){this.secret=e}async encrypt(e){const n=this.secret;if(n.length!==64)throw Error("secret must be 256 bits");const s=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.importKey("raw",pe(n),{name:"aes-gcm"},!1,["encrypt","decrypt"]),r=new TextEncoder,o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},i,r.encode(e)),a=16,h=o.slice(o.byteLength-a),d=o.slice(0,o.byteLength-a),g=new Uint8Array(h),l=new Uint8Array(d),u=new Uint8Array([...s,...g,...l]);return Fe(u)}async decrypt(e){const n=this.secret;if(n.length!==64)throw Error("secret must be 256 bits");return new Promise((s,i)=>{(async function(){const r=await crypto.subtle.importKey("raw",pe(n),{name:"aes-gcm"},!1,["encrypt","decrypt"]),o=pe(e),a=o.slice(0,12),h=o.slice(12,28),d=o.slice(28),g=new Uint8Array([...d,...h]),l={name:"AES-GCM",iv:new Uint8Array(a)};try{const u=await window.crypto.subtle.decrypt(l,r,g),c=new TextDecoder;s(c.decode(u))}catch(u){i(u)}})()})}}class cs{constructor(e,n,s){this.linkAPIUrl=e,this.sessionId=n;const i=`${n}:${s}`;this.auth=`Basic ${btoa(i)}`}async markUnseenEventsAsSeen(e){return Promise.all(e.map(n=>fetch(`${this.linkAPIUrl}/events/${n.eventId}/seen`,{method:"POST",headers:{Authorization:this.auth}}))).catch(n=>console.error("Unabled to mark event as failed:",n))}async fetchUnseenEvents(){var e;const n=await fetch(`${this.linkAPIUrl}/events?unseen=true`,{headers:{Authorization:this.auth}});if(n.ok){const{events:s,error:i}=await n.json();if(i)throw new Error(`Check unseen events failed: ${i}`);const r=(e=s?.filter(o=>o.event==="Web3Response").map(o=>({type:"Event",sessionId:this.sessionId,eventId:o.id,event:o.event,data:o.data})))!==null&&e!==void 0?e:[];return this.markUnseenEventsAsSeen(r),r}throw new Error(`Check unseen events failed: ${n.status}`)}}var Z;(function(t){t[t.DISCONNECTED=0]="DISCONNECTED",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED"})(Z||(Z={}));class ls{setConnectionStateListener(e){this.connectionStateListener=e}setIncomingDataListener(e){this.incomingDataListener=e}constructor(e,n=WebSocket){this.WebSocketClass=n,this.webSocket=null,this.pendingData=[],this.url=e.replace(/^http/,"ws")}async connect(){if(this.webSocket)throw new Error("webSocket object is not null");return new Promise((e,n)=>{var s;let i;try{this.webSocket=i=new this.WebSocketClass(this.url)}catch(r){n(r);return}(s=this.connectionStateListener)===null||s===void 0||s.call(this,Z.CONNECTING),i.onclose=r=>{var o;this.clearWebSocket(),n(new Error(`websocket error ${r.code}: ${r.reason}`)),(o=this.connectionStateListener)===null||o===void 0||o.call(this,Z.DISCONNECTED)},i.onopen=r=>{var o;e(),(o=this.connectionStateListener)===null||o===void 0||o.call(this,Z.CONNECTED),this.pendingData.length>0&&([...this.pendingData].forEach(h=>this.sendData(h)),this.pendingData=[])},i.onmessage=r=>{var o,a;if(r.data==="h")(o=this.incomingDataListener)===null||o===void 0||o.call(this,{type:"Heartbeat"});else try{const h=JSON.parse(r.data);(a=this.incomingDataListener)===null||a===void 0||a.call(this,h)}catch{}}})}disconnect(){var e;const{webSocket:n}=this;if(n){this.clearWebSocket(),(e=this.connectionStateListener)===null||e===void 0||e.call(this,Z.DISCONNECTED),this.connectionStateListener=void 0,this.incomingDataListener=void 0;try{n.close()}catch{}}}sendData(e){const{webSocket:n}=this;if(!n){this.pendingData.push(e),this.connect();return}n.send(e)}clearWebSocket(){const{webSocket:e}=this;e&&(this.webSocket=null,e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null)}}const gt=1e4,ds=6e4;class us{constructor({session:e,linkAPIUrl:n,listener:s}){this.destroyed=!1,this.lastHeartbeatResponse=0,this.nextReqId=z(1),this._connected=!1,this._linked=!1,this.shouldFetchUnseenEventsOnConnect=!1,this.requestResolutions=new Map,this.handleSessionMetadataUpdated=r=>{if(!r)return;new Map([["__destroyed",this.handleDestroyed],["EthereumAddress",this.handleAccountUpdated],["WalletUsername",this.handleWalletUsernameUpdated],["AppVersion",this.handleAppVersionUpdated],["ChainId",a=>r.JsonRpcUrl&&this.handleChainUpdated(a,r.JsonRpcUrl)]]).forEach((a,h)=>{const d=r[h];d!==void 0&&a(d)})},this.handleDestroyed=r=>{var o;r==="1"&&((o=this.listener)===null||o===void 0||o.resetAndReload())},this.handleAccountUpdated=async r=>{var o;const a=await this.cipher.decrypt(r);(o=this.listener)===null||o===void 0||o.accountUpdated(a)},this.handleMetadataUpdated=async(r,o)=>{var a;const h=await this.cipher.decrypt(o);(a=this.listener)===null||a===void 0||a.metadataUpdated(r,h)},this.handleWalletUsernameUpdated=async r=>{this.handleMetadataUpdated(is,r)},this.handleAppVersionUpdated=async r=>{this.handleMetadataUpdated(os,r)},this.handleChainUpdated=async(r,o)=>{var a;const h=await this.cipher.decrypt(r),d=await this.cipher.decrypt(o);(a=this.listener)===null||a===void 0||a.chainUpdated(h,d)},this.session=e,this.cipher=new as(e.secret),this.listener=s;const i=new ls(`${n}/rpc`,WebSocket);i.setConnectionStateListener(async r=>{let o=!1;switch(r){case Z.DISCONNECTED:if(!this.destroyed){const a=async()=>{await new Promise(h=>setTimeout(h,5e3)),this.destroyed||i.connect().catch(()=>{a()})};a()}break;case Z.CONNECTED:o=await this.handleConnected(),this.updateLastHeartbeat(),setInterval(()=>{this.heartbeat()},gt),this.shouldFetchUnseenEventsOnConnect&&this.fetchUnseenEventsAPI();break;case Z.CONNECTING:break}this.connected!==o&&(this.connected=o)}),i.setIncomingDataListener(r=>{var o;switch(r.type){case"Heartbeat":this.updateLastHeartbeat();return;case"IsLinkedOK":case"Linked":{const a=r.type==="IsLinkedOK"?r.linked:void 0;this.linked=a||r.onlineGuests>0;break}case"GetSessionConfigOK":case"SessionConfigUpdated":{this.handleSessionMetadataUpdated(r.metadata);break}case"Event":{this.handleIncomingEvent(r);break}}r.id!==void 0&&((o=this.requestResolutions.get(r.id))===null||o===void 0||o(r))}),this.ws=i,this.http=new cs(n,e.id,e.key)}connect(){if(this.destroyed)throw new Error("instance is destroyed");this.ws.connect()}async destroy(){this.destroyed||(await this.makeRequest({type:"SetSessionConfig",id:z(this.nextReqId++),sessionId:this.session.id,metadata:{__destroyed:"1"}},{timeout:1e3}),this.destroyed=!0,this.ws.disconnect(),this.listener=void 0)}get connected(){return this._connected}set connected(e){this._connected=e}get linked(){return this._linked}set linked(e){var n,s;this._linked=e,e&&((n=this.onceLinked)===null||n===void 0||n.call(this)),(s=this.listener)===null||s===void 0||s.linkedUpdated(e)}setOnceLinked(e){return new Promise(n=>{this.linked?e().then(n):this.onceLinked=()=>{e().then(n),this.onceLinked=void 0}})}async handleIncomingEvent(e){var n;if(e.type!=="Event"||e.event!=="Web3Response")return;const s=await this.cipher.decrypt(e.data),i=JSON.parse(s);if(i.type!=="WEB3_RESPONSE")return;const{id:r,response:o}=i;(n=this.listener)===null||n===void 0||n.handleWeb3ResponseMessage(r,o)}async checkUnseenEvents(){if(!this.connected){this.shouldFetchUnseenEventsOnConnect=!0;return}await new Promise(e=>setTimeout(e,250));try{await this.fetchUnseenEventsAPI()}catch(e){console.error("Unable to check for unseen events",e)}}async fetchUnseenEventsAPI(){this.shouldFetchUnseenEventsOnConnect=!1,(await this.http.fetchUnseenEvents()).forEach(n=>this.handleIncomingEvent(n))}async publishEvent(e,n,s=!1){const i=await this.cipher.encrypt(JSON.stringify(Object.assign(Object.assign({},n),{origin:location.origin,location:location.href,relaySource:"coinbaseWalletExtension"in window&&window.coinbaseWalletExtension?"injected_sdk":"sdk"}))),r={type:"PublishEvent",id:z(this.nextReqId++),sessionId:this.session.id,event:e,data:i,callWebhook:s};return this.setOnceLinked(async()=>{const o=await this.makeRequest(r);if(o.type==="Fail")throw new Error(o.error||"failed to publish event");return o.eventId})}sendData(e){this.ws.sendData(JSON.stringify(e))}updateLastHeartbeat(){this.lastHeartbeatResponse=Date.now()}heartbeat(){if(Date.now()-this.lastHeartbeatResponse>gt*2){this.ws.disconnect();return}try{this.ws.sendData("h")}catch{}}async makeRequest(e,n={timeout:ds}){const s=e.id;this.sendData(e);let i;return Promise.race([new Promise((r,o)=>{i=window.setTimeout(()=>{o(new Error(`request ${s} timed out`))},n.timeout)}),new Promise(r=>{this.requestResolutions.set(s,o=>{clearTimeout(i),r(o),this.requestResolutions.delete(s)})})])}async handleConnected(){return(await this.makeRequest({type:"HostSession",id:z(this.nextReqId++),sessionId:this.session.id,sessionKey:this.session.key})).type==="Fail"?!1:(this.sendData({type:"IsLinked",id:z(this.nextReqId++),sessionId:this.session.id}),this.sendData({type:"GetSessionConfig",id:z(this.nextReqId++),sessionId:this.session.id}),!0)}}class hs{constructor(){this._nextRequestId=0,this.callbacks=new Map}makeRequestId(){this._nextRequestId=(this._nextRequestId+1)%2147483647;const e=this._nextRequestId,n=zt(e.toString(16));return this.callbacks.get(n)&&this.callbacks.delete(n),e}}const _t="session:id",mt="session:secret",yt="session:linked";class ne{constructor(e,n,s,i=!1){this.storage=e,this.id=n,this.secret=s,this.key=Ln(An(`${n}, ${s} WalletLink`)),this._linked=!!i}static create(e){const n=X(16),s=X(32);return new ne(e,n,s).save()}static load(e){const n=e.getItem(_t),s=e.getItem(yt),i=e.getItem(mt);return n&&i?new ne(e,n,i,s==="1"):null}get linked(){return this._linked}set linked(e){this._linked=e,this.persistLinked()}save(){return this.storage.setItem(_t,this.id),this.storage.setItem(mt,this.secret),this.persistLinked(),this}persistLinked(){this.storage.setItem(yt,this._linked?"1":"0")}}function fs(){try{return window.frameElement!==null}catch{return!1}}function ps(){try{return fs()&&window.top?window.top.location:window.location}catch{return window.location}}function gs(){var t;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test((t=window?.navigator)===null||t===void 0?void 0:t.userAgent)}function en(){var t,e;return(e=(t=window?.matchMedia)===null||t===void 0?void 0:t.call(window,"(prefers-color-scheme: dark)").matches)!==null&&e!==void 0?e:!1}const _s='@namespace svg "http://www.w3.org/2000/svg";.-cbwsdk-css-reset,.-cbwsdk-css-reset *{animation:none;animation-delay:0;animation-direction:normal;animation-duration:0;animation-fill-mode:none;animation-iteration-count:1;animation-name:none;animation-play-state:running;animation-timing-function:ease;backface-visibility:visible;background:0;background-attachment:scroll;background-clip:border-box;background-color:rgba(0,0,0,0);background-image:none;background-origin:padding-box;background-position:0 0;background-position-x:0;background-position-y:0;background-repeat:repeat;background-size:auto auto;border:0;border-style:none;border-width:medium;border-color:inherit;border-bottom:0;border-bottom-color:inherit;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-style:none;border-bottom-width:medium;border-collapse:separate;border-image:none;border-left:0;border-left-color:inherit;border-left-style:none;border-left-width:medium;border-radius:0;border-right:0;border-right-color:inherit;border-right-style:none;border-right-width:medium;border-spacing:0;border-top:0;border-top-color:inherit;border-top-left-radius:0;border-top-right-radius:0;border-top-style:none;border-top-width:medium;box-shadow:none;box-sizing:border-box;caption-side:top;clear:none;clip:auto;color:inherit;columns:auto;column-count:auto;column-fill:balance;column-gap:normal;column-rule:medium none currentColor;column-rule-color:currentColor;column-rule-style:none;column-rule-width:none;column-span:1;column-width:auto;counter-increment:none;counter-reset:none;direction:ltr;empty-cells:show;float:none;font:normal;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:normal;height:auto;hyphens:none;letter-spacing:normal;line-height:normal;list-style:none;list-style-image:none;list-style-position:outside;list-style-type:disc;margin:0;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;opacity:1;orphans:0;outline:0;outline-color:invert;outline-style:none;outline-width:medium;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;perspective:none;perspective-origin:50% 50%;pointer-events:auto;position:static;quotes:"\\201C" "\\201D" "\\2018" "\\2019";tab-size:8;table-layout:auto;text-align:inherit;text-align-last:auto;text-decoration:none;text-decoration-color:inherit;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-shadow:none;text-transform:none;transform:none;transform-style:flat;transition:none;transition-delay:0s;transition-duration:0s;transition-property:none;transition-timing-function:ease;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:0;word-spacing:normal;z-index:auto}.-cbwsdk-css-reset strong{font-weight:bold}.-cbwsdk-css-reset *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;line-height:1}.-cbwsdk-css-reset [class*=container]{margin:0;padding:0}.-cbwsdk-css-reset style{display:none}';function tn(){const t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(_s)),document.documentElement.appendChild(t)}function nn(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=nn(t[e]))&&(s&&(s+=" "),s+=n);else for(e in t)t[e]&&(s&&(s+=" "),s+=e);return s}function le(){for(var t,e,n=0,s="";n<arguments.length;)(t=arguments[n++])&&(e=nn(t))&&(s&&(s+=" "),s+=e);return s}var ve,D,sn,ee,wt,rn,on,an,Ge,Ue,je,ue={},cn=[],ms=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ke=Array.isArray;function G(t,e){for(var n in e)t[n]=e[n];return t}function Ye(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function T(t,e,n){var s,i,r,o={};for(r in e)r=="key"?s=e[r]:r=="ref"?i=e[r]:o[r]=e[r];if(arguments.length>2&&(o.children=arguments.length>3?ve.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)o[r]===void 0&&(o[r]=t.defaultProps[r]);return ge(t,o,s,i,null)}function ge(t,e,n,s,i){var r={type:t,props:e,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++sn,__i:-1,__u:0};return i==null&&D.vnode!=null&&D.vnode(r),r}function Ee(t){return t.children}function _e(t,e){this.props=t,this.context=e}function se(t,e){if(e==null)return t.__?se(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?se(t):null}function ln(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return ln(t)}}function bt(t){(!t.__d&&(t.__d=!0)&&ee.push(t)&&!ye.__r++||wt!=D.debounceRendering)&&((wt=D.debounceRendering)||rn)(ye)}function ye(){for(var t,e,n,s,i,r,o,a=1;ee.length;)ee.length>a&&ee.sort(on),t=ee.shift(),a=ee.length,t.__d&&(n=void 0,i=(s=(e=t).__v).__e,r=[],o=[],e.__P&&((n=G({},s)).__v=s.__v+1,D.vnode&&D.vnode(n),Je(e.__P,n,s,e.__n,e.__P.namespaceURI,32&s.__u?[i]:null,r,i??se(s),!!(32&s.__u),o),n.__v=s.__v,n.__.__k[n.__i]=n,hn(r,n,o),n.__e!=i&&ln(n)));ye.__r=0}function dn(t,e,n,s,i,r,o,a,h,d,g){var l,u,c,f,S,b,E,C=s&&s.__k||cn,x=e.length;for(h=ys(n,e,C,h,x),l=0;l<x;l++)(c=n.__k[l])!=null&&(u=c.__i==-1?ue:C[c.__i]||ue,c.__i=l,b=Je(t,c,u,i,r,o,a,h,d,g),f=c.__e,c.ref&&u.ref!=c.ref&&(u.ref&&Qe(u.ref,null,c),g.push(c.ref,c.__c||f,c)),S==null&&f!=null&&(S=f),(E=!!(4&c.__u))||u.__k===c.__k?h=un(c,h,t,E):typeof c.type=="function"&&b!==void 0?h=b:f&&(h=f.nextSibling),c.__u&=-7);return n.__e=S,h}function ys(t,e,n,s,i){var r,o,a,h,d,g=n.length,l=g,u=0;for(t.__k=new Array(i),r=0;r<i;r++)(o=e[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(h=r+u,(o=t.__k[r]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?ge(null,o,null,null,null):ke(o)?ge(Ee,{children:o},null,null,null):o.constructor==null&&o.__b>0?ge(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=t,o.__b=t.__b+1,a=null,(d=o.__i=ws(o,n,h,l))!=-1&&(l--,(a=n[d])&&(a.__u|=2)),a==null||a.__v==null?(d==-1&&(i>g?u--:i<g&&u++),typeof o.type!="function"&&(o.__u|=4)):d!=h&&(d==h-1?u--:d==h+1?u++:(d>h?u--:u++,o.__u|=4))):t.__k[r]=null;if(l)for(r=0;r<g;r++)(a=n[r])!=null&&(2&a.__u)==0&&(a.__e==s&&(s=se(a)),pn(a,a));return s}function un(t,e,n,s){var i,r;if(typeof t.type=="function"){for(i=t.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=t,e=un(i[r],e,n,s));return e}t.__e!=e&&(s&&(e&&t.type&&!e.parentNode&&(e=se(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function ws(t,e,n,s){var i,r,o,a=t.key,h=t.type,d=e[n],g=d!=null&&(2&d.__u)==0;if(d===null&&t.key==null||g&&a==d.key&&h==d.type)return n;if(s>(g?1:0)){for(i=n-1,r=n+1;i>=0||r<e.length;)if((d=e[o=i>=0?i--:r++])!=null&&(2&d.__u)==0&&a==d.key&&h==d.type)return o}return-1}function vt(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||ms.test(e)?n:n+"px"}function fe(t,e,n,s,i){var r,o;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof s=="string"&&(t.style.cssText=s=""),s)for(e in s)n&&e in n||vt(t.style,e,"");if(n)for(e in n)s&&n[e]==s[e]||vt(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(an,"$1")),o=e.toLowerCase(),e=o in t||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?s?n.u=s.u:(n.u=Ge,t.addEventListener(e,r?je:Ue,r)):t.removeEventListener(e,r?je:Ue,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function kt(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Ge++;else if(e.t<n.u)return;return n(D.event?D.event(e):e)}}}function Je(t,e,n,s,i,r,o,a,h,d){var g,l,u,c,f,S,b,E,C,x,k,w,I,A,R,y,_,m=e.type;if(e.constructor!=null)return null;128&n.__u&&(h=!!(32&n.__u),r=[a=e.__e=n.__e]),(g=D.__b)&&g(e);e:if(typeof m=="function")try{if(E=e.props,C="prototype"in m&&m.prototype.render,x=(g=m.contextType)&&s[g.__c],k=g?x?x.props.value:g.__:s,n.__c?b=(l=e.__c=n.__c).__=l.__E:(C?e.__c=l=new m(E,k):(e.__c=l=new _e(E,k),l.constructor=m,l.render=vs),x&&x.sub(l),l.props=E,l.state||(l.state={}),l.context=k,l.__n=s,u=l.__d=!0,l.__h=[],l._sb=[]),C&&l.__s==null&&(l.__s=l.state),C&&m.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=G({},l.__s)),G(l.__s,m.getDerivedStateFromProps(E,l.__s))),c=l.props,f=l.state,l.__v=e,u)C&&m.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),C&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(C&&m.getDerivedStateFromProps==null&&E!==c&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(E,k),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(E,l.__s,k)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(l.props=E,l.state=l.__s,l.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(p){p&&(p.__=e)}),w=0;w<l._sb.length;w++)l.__h.push(l._sb[w]);l._sb=[],l.__h.length&&o.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(E,l.__s,k),C&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(c,f,S)})}if(l.context=k,l.props=E,l.__P=t,l.__e=!1,I=D.__r,A=0,C){for(l.state=l.__s,l.__d=!1,I&&I(e),g=l.render(l.props,l.state,l.context),R=0;R<l._sb.length;R++)l.__h.push(l._sb[R]);l._sb=[]}else do l.__d=!1,I&&I(e),g=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++A<25);l.state=l.__s,l.getChildContext!=null&&(s=G(G({},s),l.getChildContext())),C&&!u&&l.getSnapshotBeforeUpdate!=null&&(S=l.getSnapshotBeforeUpdate(c,f)),y=g,g!=null&&g.type===Ee&&g.key==null&&(y=fn(g.props.children)),a=dn(t,ke(y)?y:[y],e,n,s,i,r,o,a,h,d),l.base=e.__e,e.__u&=-161,l.__h.length&&o.push(l),b&&(l.__E=l.__=null)}catch(p){if(e.__v=null,h||r!=null)if(p.then){for(e.__u|=h?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,e.__e=a}else{for(_=r.length;_--;)Ye(r[_]);He(e)}else e.__e=n.__e,e.__k=n.__k,p.then||He(e);D.__e(p,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=bs(n.__e,e,n,s,i,r,o,h,d);return(g=D.diffed)&&g(e),128&e.__u?void 0:a}function He(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(He)}function hn(t,e,n){for(var s=0;s<n.length;s++)Qe(n[s],n[++s],n[++s]);D.__c&&D.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(r){r.call(i)})}catch(r){D.__e(r,i.__v)}})}function fn(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:ke(t)?t.map(fn):G({},t)}function bs(t,e,n,s,i,r,o,a,h){var d,g,l,u,c,f,S,b=n.props,E=e.props,C=e.type;if(C=="svg"?i="http://www.w3.org/2000/svg":C=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(d=0;d<r.length;d++)if((c=r[d])&&"setAttribute"in c==!!C&&(C?c.localName==C:c.nodeType==3)){t=c,r[d]=null;break}}if(t==null){if(C==null)return document.createTextNode(E);t=document.createElementNS(i,C,E.is&&E),a&&(D.__m&&D.__m(e,r),a=!1),r=null}if(C==null)b===E||a&&t.data==E||(t.data=E);else{if(r=r&&ve.call(t.childNodes),b=n.props||ue,!a&&r!=null)for(b={},d=0;d<t.attributes.length;d++)b[(c=t.attributes[d]).name]=c.value;for(d in b)if(c=b[d],d!="children"){if(d=="dangerouslySetInnerHTML")l=c;else if(!(d in E)){if(d=="value"&&"defaultValue"in E||d=="checked"&&"defaultChecked"in E)continue;fe(t,d,null,c,i)}}for(d in E)c=E[d],d=="children"?u=c:d=="dangerouslySetInnerHTML"?g=c:d=="value"?f=c:d=="checked"?S=c:a&&typeof c!="function"||b[d]===c||fe(t,d,c,b[d],i);if(g)a||l&&(g.__html==l.__html||g.__html==t.innerHTML)||(t.innerHTML=g.__html),e.__k=[];else if(l&&(t.innerHTML=""),dn(e.type=="template"?t.content:t,ke(u)?u:[u],e,n,s,C=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,o,r?r[0]:n.__k&&se(n,0),a,h),r!=null)for(d=r.length;d--;)Ye(r[d]);a||(d="value",C=="progress"&&f==null?t.removeAttribute("value"):f!=null&&(f!==t[d]||C=="progress"&&!f||C=="option"&&f!=b[d])&&fe(t,d,f,b[d],i),d="checked",S!=null&&S!=t[d]&&fe(t,d,S,b[d],i))}return t}function Qe(t,e,n){try{if(typeof t=="function"){var s=typeof t.__u=="function";s&&t.__u(),s&&e==null||(t.__u=t(e))}else t.current=e}catch(i){D.__e(i,n)}}function pn(t,e,n){var s,i;if(D.unmount&&D.unmount(t),(s=t.ref)&&(s.current&&s.current!=t.__e||Qe(s,null,e)),(s=t.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(r){D.__e(r,e)}s.base=s.__P=null}if(s=t.__k)for(i=0;i<s.length;i++)s[i]&&pn(s[i],e,n||typeof t.type!="function");n||Ye(t.__e),t.__c=t.__=t.__e=void 0}function vs(t,e,n){return this.constructor(t,n)}function Be(t,e,n){var s,i,r,o;e==document&&(e=document.documentElement),D.__&&D.__(t,e),i=(s=!1)?null:e.__k,r=[],o=[],Je(e,t=e.__k=T(Ee,null,[t]),i||ue,ue,e.namespaceURI,i?null:e.firstChild?ve.call(e.childNodes):null,r,i?i.__e:e.firstChild,s,o),hn(r,t,o)}ve=cn.slice,D={__e:function(t,e,n,s){for(var i,r,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(t)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,s||{}),o=i.__d),o)return i.__E=i}catch(a){t=a}throw t}},sn=0,_e.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=G({},this.state),typeof t=="function"&&(t=t(G({},n),this.props)),t&&G(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),bt(this))},_e.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),bt(this))},_e.prototype.render=Ee,ee=[],rn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,on=function(t,e){return t.__v.__b-e.__v.__b},ye.__r=0,an=/(PointerCapture)$|Capture$/i,Ge=0,Ue=kt(!1),je=kt(!0);var we,j,Re,Et,We=0,gn=[],H=D,Ct=H.__b,St=H.__r,It=H.diffed,Lt=H.__c,At=H.unmount,xt=H.__;function _n(t,e){H.__h&&H.__h(j,t,We||e),We=0;var n=j.__H||(j.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function Mt(t){return We=1,ks(mn,t)}function ks(t,e,n){var s=_n(we++,2);if(s.t=t,!s.__c&&(s.__=[mn(void 0,e),function(a){var h=s.__N?s.__N[0]:s.__[0],d=s.t(h,a);h!==d&&(s.__N=[d,s.__[1]],s.__c.setState({}))}],s.__c=j,!j.__f)){var i=function(a,h,d){if(!s.__c.__H)return!0;var g=s.__c.__H.__.filter(function(u){return!!u.__c});if(g.every(function(u){return!u.__N}))return!r||r.call(this,a,h,d);var l=s.__c.props!==a;return g.forEach(function(u){if(u.__N){var c=u.__[0];u.__=u.__N,u.__N=void 0,c!==u.__[0]&&(l=!0)}}),r&&r.call(this,a,h,d)||l};j.__f=!0;var r=j.shouldComponentUpdate,o=j.componentWillUpdate;j.componentWillUpdate=function(a,h,d){if(this.__e){var g=r;r=void 0,i(a,h,d),r=g}o&&o.call(this,a,h,d)},j.shouldComponentUpdate=i}return s.__N||s.__}function Es(t,e){var n=_n(we++,3);!H.__s&&Is(n.__H,e)&&(n.__=t,n.u=e,j.__H.__h.push(n))}function Cs(){for(var t;t=gn.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(me),t.__H.__h.forEach(qe),t.__H.__h=[]}catch(e){t.__H.__h=[],H.__e(e,t.__v)}}H.__b=function(t){j=null,Ct&&Ct(t)},H.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),xt&&xt(t,e)},H.__r=function(t){St&&St(t),we=0;var e=(j=t.__c).__H;e&&(Re===j?(e.__h=[],j.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(me),e.__h.forEach(qe),e.__h=[],we=0)),Re=j},H.diffed=function(t){It&&It(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(gn.push(e)!==1&&Et===H.requestAnimationFrame||((Et=H.requestAnimationFrame)||Ss)(Cs)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Re=j=null},H.__c=function(t,e){e.some(function(n){try{n.__h.forEach(me),n.__h=n.__h.filter(function(s){return!s.__||qe(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],H.__e(s,n.__v)}}),Lt&&Lt(t,e)},H.unmount=function(t){At&&At(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(s){try{me(s)}catch(i){e=i}}),n.__H=void 0,e&&H.__e(e,n.__v))};var Pt=typeof requestAnimationFrame=="function";function Ss(t){var e,n=function(){clearTimeout(s),Pt&&cancelAnimationFrame(e),setTimeout(t)},s=setTimeout(n,35);Pt&&(e=requestAnimationFrame(n))}function me(t){var e=j,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),j=e}function qe(t){var e=j;t.__c=t.__(),j=e}function Is(t,e){return!t||t.length!==e.length||e.some(function(n,s){return n!==t[s]})}function mn(t,e){return typeof e=="function"?e(t):e}const Ls=".-cbwsdk-css-reset .-gear-container{margin-left:16px !important;margin-right:9px !important;display:flex;align-items:center;justify-content:center;width:24px;height:24px;transition:opacity .25s}.-cbwsdk-css-reset .-gear-container *{user-select:none}.-cbwsdk-css-reset .-gear-container svg{opacity:0;position:absolute}.-cbwsdk-css-reset .-gear-icon{height:12px;width:12px;z-index:10000}.-cbwsdk-css-reset .-cbwsdk-snackbar{align-items:flex-end;display:flex;flex-direction:column;position:fixed;right:0;top:0;z-index:2147483647}.-cbwsdk-css-reset .-cbwsdk-snackbar *{user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance{display:flex;flex-direction:column;margin:8px 16px 0 16px;overflow:visible;text-align:left;transform:translateX(0);transition:opacity .25s,transform .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header:hover .-gear-container svg{opacity:1}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header{display:flex;align-items:center;background:#fff;overflow:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-cblogo{margin:8px 8px 8px 8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-message{color:#000;font-size:13px;line-height:1.5;user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu{background:#fff;transition:opacity .25s ease-in-out,transform .25s linear,visibility 0s;visibility:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;opacity:0;flex-direction:column;padding-left:8px;padding-right:8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:last-child{margin-bottom:8px !important}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover{background:#f5f7f8;border-radius:6px;transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover span{color:#050f19;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover svg path{fill:#000;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item{visibility:inherit;height:35px;margin-top:8px;margin-bottom:0;display:flex;flex-direction:row;align-items:center;padding:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item *{visibility:inherit;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover{background:rgba(223,95,103,.2);transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover svg path{fill:#df5f67;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover span{color:#df5f67;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-info{color:#aaa;font-size:13px;margin:0 8px 0 32px;position:absolute}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-hidden{opacity:0;text-align:left;transform:translateX(25%);transition:opacity .5s linear}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-expanded .-cbwsdk-snackbar-instance-menu{opacity:1;display:flex;transform:translateY(8px);visibility:visible}",As="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEuNDkyIDEwLjQxOWE4LjkzIDguOTMgMCAwMTguOTMtOC45M2gxMS4xNjNhOC45MyA4LjkzIDAgMDE4LjkzIDguOTN2MTEuMTYzYTguOTMgOC45MyAwIDAxLTguOTMgOC45M0gxMC40MjJhOC45MyA4LjkzIDAgMDEtOC45My04LjkzVjEwLjQxOXoiIGZpbGw9IiMxNjUyRjAiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwLjQxOSAwSDIxLjU4QzI3LjMzNSAwIDMyIDQuNjY1IDMyIDEwLjQxOVYyMS41OEMzMiAyNy4zMzUgMjcuMzM1IDMyIDIxLjU4MSAzMkgxMC40MkM0LjY2NSAzMiAwIDI3LjMzNSAwIDIxLjU4MVYxMC40MkMwIDQuNjY1IDQuNjY1IDAgMTAuNDE5IDB6bTAgMS40ODhhOC45MyA4LjkzIDAgMDAtOC45MyA4LjkzdjExLjE2M2E4LjkzIDguOTMgMCAwMDguOTMgOC45M0gyMS41OGE4LjkzIDguOTMgMCAwMDguOTMtOC45M1YxMC40MmE4LjkzIDguOTMgMCAwMC04LjkzLTguOTNIMTAuNDJ6IiBmaWxsPSIjZmZmIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNS45OTggMjYuMDQ5Yy01LjU0OSAwLTEwLjA0Ny00LjQ5OC0xMC4wNDctMTAuMDQ3IDAtNS41NDggNC40OTgtMTAuMDQ2IDEwLjA0Ny0xMC4wNDYgNS41NDggMCAxMC4wNDYgNC40OTggMTAuMDQ2IDEwLjA0NiAwIDUuNTQ5LTQuNDk4IDEwLjA0Ny0xMC4wNDYgMTAuMDQ3eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xMi43NjIgMTQuMjU0YzAtLjgyMi42NjctMS40ODkgMS40ODktMS40ODloMy40OTdjLjgyMiAwIDEuNDg4LjY2NiAxLjQ4OCAxLjQ4OXYzLjQ5N2MwIC44MjItLjY2NiAxLjQ4OC0xLjQ4OCAxLjQ4OGgtMy40OTdhMS40ODggMS40ODggMCAwMS0xLjQ4OS0xLjQ4OHYtMy40OTh6IiBmaWxsPSIjMTY1MkYwIi8+PC9zdmc+",xs="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDYuNzV2LTEuNWwtMS43Mi0uNTdjLS4wOC0uMjctLjE5LS41Mi0uMzItLjc3bC44MS0xLjYyLTEuMDYtMS4wNi0xLjYyLjgxYy0uMjQtLjEzLS41LS4yNC0uNzctLjMyTDYuNzUgMGgtMS41bC0uNTcgMS43MmMtLjI3LjA4LS41My4xOS0uNzcuMzJsLTEuNjItLjgxLTEuMDYgMS4wNi44MSAxLjYyYy0uMTMuMjQtLjI0LjUtLjMyLjc3TDAgNS4yNXYxLjVsMS43Mi41N2MuMDguMjcuMTkuNTMuMzIuNzdsLS44MSAxLjYyIDEuMDYgMS4wNiAxLjYyLS44MWMuMjQuMTMuNS4yMy43Ny4zMkw1LjI1IDEyaDEuNWwuNTctMS43MmMuMjctLjA4LjUyLS4xOS43Ny0uMzJsMS42Mi44MSAxLjA2LTEuMDYtLjgxLTEuNjJjLjEzLS4yNC4yMy0uNS4zMi0uNzdMMTIgNi43NXpNNiA4LjVhMi41IDIuNSAwIDAxMC01IDIuNSAyLjUgMCAwMTAgNXoiIGZpbGw9IiMwNTBGMTkiLz48L3N2Zz4=";class Ms{constructor(){this.items=new Map,this.nextItemKey=0,this.root=null,this.darkMode=en()}attach(e){this.root=document.createElement("div"),this.root.className="-cbwsdk-snackbar-root",e.appendChild(this.root),this.render()}presentItem(e){const n=this.nextItemKey++;return this.items.set(n,e),this.render(),()=>{this.items.delete(n),this.render()}}clear(){this.items.clear(),this.render()}render(){this.root&&Be(T("div",null,T(yn,{darkMode:this.darkMode},Array.from(this.items.entries()).map(([e,n])=>T(Ps,Object.assign({},n,{key:e}))))),this.root)}}const yn=t=>T("div",{class:le("-cbwsdk-snackbar-container")},T("style",null,Ls),T("div",{class:"-cbwsdk-snackbar"},t.children)),Ps=({autoExpand:t,message:e,menuItems:n})=>{const[s,i]=Mt(!0),[r,o]=Mt(t??!1);Es(()=>{const h=[window.setTimeout(()=>{i(!1)},1),window.setTimeout(()=>{o(!0)},1e4)];return()=>{h.forEach(window.clearTimeout)}});const a=()=>{o(!r)};return T("div",{class:le("-cbwsdk-snackbar-instance",s&&"-cbwsdk-snackbar-instance-hidden",r&&"-cbwsdk-snackbar-instance-expanded")},T("div",{class:"-cbwsdk-snackbar-instance-header",onClick:a},T("img",{src:As,class:"-cbwsdk-snackbar-instance-header-cblogo"})," ",T("div",{class:"-cbwsdk-snackbar-instance-header-message"},e),T("div",{class:"-gear-container"},!r&&T("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},T("circle",{cx:"12",cy:"12",r:"12",fill:"#F5F7F8"})),T("img",{src:xs,class:"-gear-icon",title:"Expand"}))),n&&n.length>0&&T("div",{class:"-cbwsdk-snackbar-instance-menu"},n.map((h,d)=>T("div",{class:le("-cbwsdk-snackbar-instance-menu-item",h.isRed&&"-cbwsdk-snackbar-instance-menu-item-is-red"),onClick:h.onClick,key:d},T("svg",{width:h.svgWidth,height:h.svgHeight,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},T("path",{"fill-rule":h.defaultFillRule,"clip-rule":h.defaultClipRule,d:h.path,fill:"#AAAAAA"})),T("span",{class:le("-cbwsdk-snackbar-instance-menu-item-info",h.isRed&&"-cbwsdk-snackbar-instance-menu-item-info-is-red")},h.info)))))};class Rs{constructor(){this.attached=!1,this.snackbar=new Ms}attach(){if(this.attached)throw new Error("Coinbase Wallet SDK UI is already attached");const e=document.documentElement,n=document.createElement("div");n.className="-cbwsdk-css-reset",e.appendChild(n),this.snackbar.attach(n),this.attached=!0,tn()}showConnecting(e){let n;return e.isUnlinkedErrorState?n={autoExpand:!0,message:"Connection lost",menuItems:[{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:"M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:e.onResetConnection}]}:n={message:"Confirm on phone",menuItems:[{isRed:!0,info:"Cancel transaction",svgWidth:"11",svgHeight:"11",path:"M10.3711 1.52346L9.21775 0.370117L5.37109 4.21022L1.52444 0.370117L0.371094 1.52346L4.2112 5.37012L0.371094 9.21677L1.52444 10.3701L5.37109 6.53001L9.21775 10.3701L10.3711 9.21677L6.53099 5.37012L10.3711 1.52346Z",defaultFillRule:"inherit",defaultClipRule:"inherit",onClick:e.onCancel},{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:"M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:e.onResetConnection}]},this.snackbar.presentItem(n)}}const Ts=".-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;transition:opacity .25s;background-color:rgba(10,11,13,.5)}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop-hidden{opacity:0}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box{display:block;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);padding:20px;border-radius:8px;background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box p{display:block;font-weight:400;font-size:14px;line-height:20px;padding-bottom:12px;color:#5b636e}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box button{appearance:none;border:none;background:none;color:#0052ff;padding:0;text-decoration:none;display:block;font-weight:600;font-size:16px;line-height:24px}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark{background-color:#0a0b0d;color:#fff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark button{color:#0052ff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light{background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light button{color:#0052ff}";class Ns{constructor(){this.root=null,this.darkMode=en()}attach(){const e=document.documentElement;this.root=document.createElement("div"),this.root.className="-cbwsdk-css-reset",e.appendChild(this.root),tn()}present(e){this.render(e)}clear(){this.render(null)}render(e){this.root&&(Be(null,this.root),e&&Be(T(Os,Object.assign({},e,{onDismiss:()=>{this.clear()},darkMode:this.darkMode})),this.root))}}const Os=({title:t,buttonText:e,darkMode:n,onButtonClick:s,onDismiss:i})=>{const r=n?"dark":"light";return T(yn,{darkMode:n},T("div",{class:"-cbwsdk-redirect-dialog"},T("style",null,Ts),T("div",{class:"-cbwsdk-redirect-dialog-backdrop",onClick:i}),T("div",{class:le("-cbwsdk-redirect-dialog-box",r)},T("p",null,t),T("button",{onClick:s},e))))},Ds="https://keys.coinbase.com/connect",Us="http://rpc.wallet.coinbase.com",Rt="https://www.walletlink.org",js="https://go.cb-w.com/walletlink";class Tt{constructor(){this.attached=!1,this.redirectDialog=new Ns}attach(){if(this.attached)throw new Error("Coinbase Wallet SDK UI is already attached");this.redirectDialog.attach(),this.attached=!0}redirectToCoinbaseWallet(e){const n=new URL(js);n.searchParams.append("redirect_url",ps().href),e&&n.searchParams.append("wl_url",e);const s=document.createElement("a");s.target="cbw-opener",s.href=n.href,s.rel="noreferrer noopener",s.click()}openCoinbaseWalletDeeplink(e){this.redirectDialog.present({title:"Redirecting to Coinbase Wallet...",buttonText:"Open",onButtonClick:()=>{this.redirectToCoinbaseWallet(e)}}),setTimeout(()=>{this.redirectToCoinbaseWallet(e)},99)}showConnecting(e){return()=>{this.redirectDialog.clear()}}}class ${constructor(e){this.chainCallbackParams={chainId:"",jsonRpcUrl:""},this.isMobileWeb=gs(),this.linkedUpdated=r=>{this.isLinked=r;const o=this.storage.getItem(De);if(r&&(this._session.linked=r),this.isUnlinkedErrorState=!1,o){const a=o.split(" "),h=this.storage.getItem("IsStandaloneSigning")==="true";a[0]!==""&&!r&&this._session.linked&&!h&&(this.isUnlinkedErrorState=!0)}},this.metadataUpdated=(r,o)=>{this.storage.setItem(r,o)},this.chainUpdated=(r,o)=>{this.chainCallbackParams.chainId===r&&this.chainCallbackParams.jsonRpcUrl===o||(this.chainCallbackParams={chainId:r,jsonRpcUrl:o},this.chainCallback&&this.chainCallback(o,Number.parseInt(r,10)))},this.accountUpdated=r=>{this.accountsCallback&&this.accountsCallback([r]),$.accountRequestCallbackIds.size>0&&(Array.from($.accountRequestCallbackIds.values()).forEach(o=>{this.invokeCallback(o,{method:"requestEthereumAccounts",result:[r]})}),$.accountRequestCallbackIds.clear())},this.resetAndReload=this.resetAndReload.bind(this),this.linkAPIUrl=e.linkAPIUrl,this.storage=e.storage,this.metadata=e.metadata,this.accountsCallback=e.accountsCallback,this.chainCallback=e.chainCallback;const{session:n,ui:s,connection:i}=this.subscribe();this._session=n,this.connection=i,this.relayEventManager=new hs,this.ui=s,this.ui.attach()}subscribe(){const e=ne.load(this.storage)||ne.create(this.storage),{linkAPIUrl:n}=this,s=new us({session:e,linkAPIUrl:n,listener:this}),i=this.isMobileWeb?new Tt:new Rs;return s.connect(),{session:e,ui:i,connection:s}}resetAndReload(){this.connection.destroy().then(()=>{const e=ne.load(this.storage);e?.id===this._session.id&&K.clearAll(),document.location.reload()}).catch(e=>{})}signEthereumTransaction(e){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:e.fromAddress,toAddress:e.toAddress,weiValue:F(e.weiValue),data:ae(e.data,!0),nonce:e.nonce,gasPriceInWei:e.gasPriceInWei?F(e.gasPriceInWei):null,maxFeePerGas:e.gasPriceInWei?F(e.gasPriceInWei):null,maxPriorityFeePerGas:e.gasPriceInWei?F(e.gasPriceInWei):null,gasLimit:e.gasLimit?F(e.gasLimit):null,chainId:e.chainId,shouldSubmit:!1}})}signAndSubmitEthereumTransaction(e){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:e.fromAddress,toAddress:e.toAddress,weiValue:F(e.weiValue),data:ae(e.data,!0),nonce:e.nonce,gasPriceInWei:e.gasPriceInWei?F(e.gasPriceInWei):null,maxFeePerGas:e.maxFeePerGas?F(e.maxFeePerGas):null,maxPriorityFeePerGas:e.maxPriorityFeePerGas?F(e.maxPriorityFeePerGas):null,gasLimit:e.gasLimit?F(e.gasLimit):null,chainId:e.chainId,shouldSubmit:!0}})}submitEthereumTransaction(e,n){return this.sendRequest({method:"submitEthereumTransaction",params:{signedTransaction:ae(e,!0),chainId:n}})}getWalletLinkSession(){return this._session}sendRequest(e){let n=null;const s=X(8),i=r=>{this.publishWeb3RequestCanceledEvent(s),this.handleErrorResponse(s,e.method,r),n?.()};return new Promise((r,o)=>{n=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:i,onResetConnection:this.resetAndReload}),this.relayEventManager.callbacks.set(s,a=>{if(n?.(),q(a))return o(new Error(a.errorMessage));r(a)}),this.publishWeb3RequestEvent(s,e)})}publishWeb3RequestEvent(e,n){const s={type:"WEB3_REQUEST",id:e,request:n};this.publishEvent("Web3Request",s,!0).then(i=>{}).catch(i=>{this.handleWeb3ResponseMessage(s.id,{method:n.method,errorMessage:i.message})}),this.isMobileWeb&&this.openCoinbaseWalletDeeplink(n.method)}openCoinbaseWalletDeeplink(e){if(this.ui instanceof Tt)switch(e){case"requestEthereumAccounts":case"switchEthereumChain":return;default:window.addEventListener("blur",()=>{window.addEventListener("focus",()=>{this.connection.checkUnseenEvents()},{once:!0})},{once:!0}),this.ui.openCoinbaseWalletDeeplink();break}}publishWeb3RequestCanceledEvent(e){const n={type:"WEB3_REQUEST_CANCELED",id:e};this.publishEvent("Web3RequestCanceled",n,!1).then()}publishEvent(e,n,s){return this.connection.publishEvent(e,n,s)}handleWeb3ResponseMessage(e,n){if(n.method==="requestEthereumAccounts"){$.accountRequestCallbackIds.forEach(s=>this.invokeCallback(s,n)),$.accountRequestCallbackIds.clear();return}this.invokeCallback(e,n)}handleErrorResponse(e,n,s){var i;const r=(i=s?.message)!==null&&i!==void 0?i:"Unspecified error message.";this.handleWeb3ResponseMessage(e,{method:n,errorMessage:r})}invokeCallback(e,n){const s=this.relayEventManager.callbacks.get(e);s&&(s(n),this.relayEventManager.callbacks.delete(e))}requestEthereumAccounts(){const{appName:e,appLogoUrl:n}=this.metadata,s={method:"requestEthereumAccounts",params:{appName:e,appLogoUrl:n}},i=X(8);return new Promise((r,o)=>{this.relayEventManager.callbacks.set(i,a=>{if(q(a))return o(new Error(a.errorMessage));r(a)}),$.accountRequestCallbackIds.add(i),this.publishWeb3RequestEvent(i,s)})}watchAsset(e,n,s,i,r,o){const a={method:"watchAsset",params:{type:e,options:{address:n,symbol:s,decimals:i,image:r},chainId:o}};let h=null;const d=X(8),g=l=>{this.publishWeb3RequestCanceledEvent(d),this.handleErrorResponse(d,a.method,l),h?.()};return h=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:g,onResetConnection:this.resetAndReload}),new Promise((l,u)=>{this.relayEventManager.callbacks.set(d,c=>{if(h?.(),q(c))return u(new Error(c.errorMessage));l(c)}),this.publishWeb3RequestEvent(d,a)})}addEthereumChain(e,n,s,i,r,o){const a={method:"addEthereumChain",params:{chainId:e,rpcUrls:n,blockExplorerUrls:i,chainName:r,iconUrls:s,nativeCurrency:o}};let h=null;const d=X(8),g=l=>{this.publishWeb3RequestCanceledEvent(d),this.handleErrorResponse(d,a.method,l),h?.()};return h=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:g,onResetConnection:this.resetAndReload}),new Promise((l,u)=>{this.relayEventManager.callbacks.set(d,c=>{if(h?.(),q(c))return u(new Error(c.errorMessage));l(c)}),this.publishWeb3RequestEvent(d,a)})}switchEthereumChain(e,n){const s={method:"switchEthereumChain",params:Object.assign({chainId:e},{address:n})};let i=null;const r=X(8),o=a=>{this.publishWeb3RequestCanceledEvent(r),this.handleErrorResponse(r,s.method,a),i?.()};return i=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:o,onResetConnection:this.resetAndReload}),new Promise((a,h)=>{this.relayEventManager.callbacks.set(r,d=>{if(i?.(),q(d)&&d.errorCode)return h(P.provider.custom({code:d.errorCode,message:"Unrecognized chain ID. Try adding the chain using addEthereumChain first."}));if(q(d))return h(new Error(d.errorMessage));a(d)}),this.publishWeb3RequestEvent(r,s)})}}$.accountRequestCallbackIds=new Set;const Nt="DefaultChainId",Ot="DefaultJsonRpcUrl";class wn{constructor(e){this._relay=null,this._addresses=[],this.metadata=e.metadata,this._storage=new K("walletlink",Rt),this.callback=e.callback||null;const n=this._storage.getItem(De);if(n){const s=n.split(" ");s[0]!==""&&(this._addresses=s.map(i=>Y(i)))}this.initializeRelay()}getSession(){const e=this.initializeRelay(),{id:n,secret:s}=e.getWalletLinkSession();return{id:n,secret:s}}async handshake(){await this._eth_requestAccounts()}get selectedAddress(){return this._addresses[0]||void 0}get jsonRpcUrl(){var e;return(e=this._storage.getItem(Ot))!==null&&e!==void 0?e:void 0}set jsonRpcUrl(e){this._storage.setItem(Ot,e)}updateProviderInfo(e,n){var s;this.jsonRpcUrl=e;const i=this.getChainId();this._storage.setItem(Nt,n.toString(10)),ce(n)!==i&&((s=this.callback)===null||s===void 0||s.call(this,"chainChanged",Q(n)))}async watchAsset(e){const n=Array.isArray(e)?e[0]:e;if(!n.type)throw P.rpc.invalidParams("Type is required");if(n?.type!=="ERC20")throw P.rpc.invalidParams(`Asset of type '${n.type}' is not supported`);if(!n?.options)throw P.rpc.invalidParams("Options are required");if(!n?.options.address)throw P.rpc.invalidParams("Address is required");const s=this.getChainId(),{address:i,symbol:r,image:o,decimals:a}=n.options,d=await this.initializeRelay().watchAsset(n.type,i,r,a,o,s?.toString());return q(d)?!1:!!d.result}async addEthereumChain(e){var n,s;const i=e[0];if(((n=i.rpcUrls)===null||n===void 0?void 0:n.length)===0)throw P.rpc.invalidParams("please pass in at least 1 rpcUrl");if(!i.chainName||i.chainName.trim()==="")throw P.rpc.invalidParams("chainName is a required field");if(!i.nativeCurrency)throw P.rpc.invalidParams("nativeCurrency is a required field");const r=Number.parseInt(i.chainId,16);if(r===this.getChainId())return!1;const o=this.initializeRelay(),{rpcUrls:a=[],blockExplorerUrls:h=[],chainName:d,iconUrls:g=[],nativeCurrency:l}=i,u=await o.addEthereumChain(r.toString(),a,g,h,d,l);if(q(u))return!1;if(((s=u.result)===null||s===void 0?void 0:s.isApproved)===!0)return this.updateProviderInfo(a[0],r),null;throw P.rpc.internal("unable to add ethereum chain")}async switchEthereumChain(e){const n=e[0],s=Number.parseInt(n.chainId,16),r=await this.initializeRelay().switchEthereumChain(s.toString(10),this.selectedAddress||void 0);if(q(r))throw r;const o=r.result;return o.isApproved&&o.rpcUrl.length>0&&this.updateProviderInfo(o.rpcUrl,s),null}async cleanup(){this.callback=null,this._relay&&this._relay.resetAndReload(),this._storage.clear()}_setAddresses(e,n){var s;if(!Array.isArray(e))throw new Error("addresses is not an array");const i=e.map(r=>Y(r));JSON.stringify(i)!==JSON.stringify(this._addresses)&&(this._addresses=i,(s=this.callback)===null||s===void 0||s.call(this,"accountsChanged",i),this._storage.setItem(De,i.join(" ")))}async request(e){const n=e.params||[];switch(e.method){case"eth_accounts":return[...this._addresses];case"eth_coinbase":return this.selectedAddress||null;case"net_version":return this.getChainId().toString(10);case"eth_chainId":return Q(this.getChainId());case"eth_requestAccounts":return this._eth_requestAccounts();case"eth_ecRecover":case"personal_ecRecover":return this.ecRecover(e);case"personal_sign":return this.personalSign(e);case"eth_signTransaction":return this._eth_signTransaction(n);case"eth_sendRawTransaction":return this._eth_sendRawTransaction(n);case"eth_sendTransaction":return this._eth_sendTransaction(n);case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":return this.signTypedData(e);case"wallet_addEthereumChain":return this.addEthereumChain(n);case"wallet_switchEthereumChain":return this.switchEthereumChain(n);case"wallet_watchAsset":return this.watchAsset(n);default:if(!this.jsonRpcUrl)throw P.rpc.internal("No RPC URL set for chain");return Ze(e,this.jsonRpcUrl)}}_ensureKnownAddress(e){const n=Y(e);if(!this._addresses.map(i=>Y(i)).includes(n))throw new Error("Unknown Ethereum address")}_prepareTransactionParams(e){const n=e.from?Y(e.from):this.selectedAddress;if(!n)throw new Error("Ethereum address is unavailable");this._ensureKnownAddress(n);const s=e.to?Y(e.to):null,i=e.value!=null?ie(e.value):BigInt(0),r=e.data?Oe(e.data):Buffer.alloc(0),o=e.nonce!=null?ce(e.nonce):null,a=e.gasPrice!=null?ie(e.gasPrice):null,h=e.maxFeePerGas!=null?ie(e.maxFeePerGas):null,d=e.maxPriorityFeePerGas!=null?ie(e.maxPriorityFeePerGas):null,g=e.gas!=null?ie(e.gas):null,l=e.chainId?ce(e.chainId):this.getChainId();return{fromAddress:n,toAddress:s,weiValue:i,data:r,nonce:o,gasPriceInWei:a,maxFeePerGas:h,maxPriorityFeePerGas:d,gasLimit:g,chainId:l}}async ecRecover(e){const{method:n,params:s}=e;if(!Array.isArray(s))throw P.rpc.invalidParams();const r=await this.initializeRelay().sendRequest({method:"ethereumAddressFromSignedMessage",params:{message:Ce(s[0]),signature:Ce(s[1]),addPrefix:n==="personal_ecRecover"}});if(q(r))throw r;return r.result}getChainId(){var e;return Number.parseInt((e=this._storage.getItem(Nt))!==null&&e!==void 0?e:"1",10)}async _eth_requestAccounts(){var e,n;if(this._addresses.length>0)return(e=this.callback)===null||e===void 0||e.call(this,"connect",{chainId:Q(this.getChainId())}),this._addresses;const i=await this.initializeRelay().requestEthereumAccounts();if(q(i))throw i;if(!i.result)throw new Error("accounts received is empty");return this._setAddresses(i.result),(n=this.callback)===null||n===void 0||n.call(this,"connect",{chainId:Q(this.getChainId())}),this._addresses}async personalSign({params:e}){if(!Array.isArray(e))throw P.rpc.invalidParams();const n=e[1],s=e[0];this._ensureKnownAddress(n);const r=await this.initializeRelay().sendRequest({method:"signEthereumMessage",params:{address:Y(n),message:Ce(s),addPrefix:!0,typedDataJson:null}});if(q(r))throw r;return r.result}async _eth_signTransaction(e){const n=this._prepareTransactionParams(e[0]||{}),i=await this.initializeRelay().signEthereumTransaction(n);if(q(i))throw i;return i.result}async _eth_sendRawTransaction(e){const n=Oe(e[0]),i=await this.initializeRelay().submitEthereumTransaction(n,this.getChainId());if(q(i))throw i;return i.result}async _eth_sendTransaction(e){const n=this._prepareTransactionParams(e[0]||{}),i=await this.initializeRelay().signAndSubmitEthereumTransaction(n);if(q(i))throw i;return i.result}async signTypedData(e){const{method:n,params:s}=e;if(!Array.isArray(s))throw P.rpc.invalidParams();const i=d=>{const g={eth_signTypedData_v1:he.hashForSignTypedDataLegacy,eth_signTypedData_v3:he.hashForSignTypedData_v3,eth_signTypedData_v4:he.hashForSignTypedData_v4,eth_signTypedData:he.hashForSignTypedData_v4};return ae(g[n]({data:jn(d)}),!0)},r=s[n==="eth_signTypedData_v1"?1:0],o=s[n==="eth_signTypedData_v1"?0:1];this._ensureKnownAddress(r);const h=await this.initializeRelay().sendRequest({method:"signEthereumMessage",params:{address:Y(r),message:i(o),typedDataJson:JSON.stringify(o,null,2),addPrefix:!1}});if(q(h))throw h;return h.result}initializeRelay(){return this._relay||(this._relay=new $({linkAPIUrl:Rt,storage:this._storage,metadata:this.metadata,accountsCallback:this._setAddresses.bind(this),chainCallback:this.updateProviderInfo.bind(this)})),this._relay}}const bn="SignerType",vn=new K("CBWSDK","SignerConfigurator");function Hs(){return vn.getItem(bn)}function Bs(t){vn.setItem(bn,t)}async function Ws(t){const{communicator:e,metadata:n,handshakeRequest:s,callback:i}=t;Vs(e,n,i).catch(()=>{});const r={id:crypto.randomUUID(),event:"selectSignerType",data:Object.assign(Object.assign({},t.preference),{handshakeRequest:s})},{data:o}=await e.postRequestAndWaitForResponse(r);return o}function qs(t){const{signerType:e,metadata:n,communicator:s,callback:i}=t;switch(e){case"scw":return new Jn({metadata:n,callback:i,communicator:s});case"walletlink":return new wn({metadata:n,callback:i})}}async function Vs(t,e,n){await t.onMessage(({event:i})=>i==="WalletLinkSessionRequest");const s=new wn({metadata:e,callback:n});t.postMessage({event:"WalletLinkUpdate",data:{session:s.getSession()}}),await s.handshake(),t.postMessage({event:"WalletLinkUpdate",data:{connected:!0}})}const Ks=`Coinbase Wallet SDK requires the Cross-Origin-Opener-Policy header to not be set to 'same-origin'. This is to ensure that the SDK can communicate with the Coinbase Smart Wallet app.

Please see https://www.smartwallet.dev/guides/tips/popup-tips#cross-origin-opener-policy for more information.`,Fs=()=>{let t;return{getCrossOriginOpenerPolicy:()=>t===void 0?"undefined":t,checkCrossOriginOpenerPolicy:async()=>{if(typeof window>"u"){t="non-browser-env";return}try{const e=`${window.location.origin}${window.location.pathname}`,n=await fetch(e,{method:"HEAD"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("Cross-Origin-Opener-Policy");t=s??"null",t==="same-origin"&&console.error(Ks)}catch(e){console.error("Error checking Cross-Origin-Opener-Policy:",e.message),t="error"}}}},{checkCrossOriginOpenerPolicy:kn,getCrossOriginOpenerPolicy:zs}=Fs(),Dt=420,Ut=540;function $s(t){const e=(window.innerWidth-Dt)/2+window.screenX,n=(window.innerHeight-Ut)/2+window.screenY;Gs(t);const s=`wallet_${crypto.randomUUID()}`,i=window.open(t,s,`width=${Dt}, height=${Ut}, left=${e}, top=${n}`);if(i?.focus(),!i)throw P.rpc.internal("Pop up window failed to open");return i}function Zs(t){t&&!t.closed&&t.close()}function Gs(t){const e={sdkName:Yt,sdkVersion:re,origin:window.location.origin,coop:zs()};for(const[n,s]of Object.entries(e))t.searchParams.append(n,s.toString())}class Ys{constructor({url:e=Ds,metadata:n,preference:s}){this.popup=null,this.listeners=new Map,this.postMessage=async i=>{(await this.waitForPopupLoaded()).postMessage(i,this.url.origin)},this.postRequestAndWaitForResponse=async i=>{const r=this.onMessage(({requestId:o})=>o===i.id);return this.postMessage(i),await r},this.onMessage=async i=>new Promise((r,o)=>{const a=h=>{if(h.origin!==this.url.origin)return;const d=h.data;i(d)&&(r(d),window.removeEventListener("message",a),this.listeners.delete(a))};window.addEventListener("message",a),this.listeners.set(a,{reject:o})}),this.disconnect=()=>{Zs(this.popup),this.popup=null,this.listeners.forEach(({reject:i},r)=>{i(P.provider.userRejectedRequest("Request rejected")),window.removeEventListener("message",r)}),this.listeners.clear()},this.waitForPopupLoaded=async()=>this.popup&&!this.popup.closed?(this.popup.focus(),this.popup):(this.popup=$s(this.url),this.onMessage(({event:i})=>i==="PopupUnload").then(this.disconnect).catch(()=>{}),this.onMessage(({event:i})=>i==="PopupLoaded").then(i=>{this.postMessage({requestId:i.id,data:{version:re,metadata:this.metadata,preference:this.preference,location:window.location.toString()}})}).then(()=>{if(!this.popup)throw P.rpc.internal();return this.popup})),this.url=new URL(e),this.metadata=n,this.preference=s}}function Js(t){const e=Tn(Qs(t),{shouldIncludeStack:!0}),n=new URL("https://docs.cloud.coinbase.com/wallet-sdk/docs/errors");return n.searchParams.set("version",re),n.searchParams.set("code",e.code.toString()),n.searchParams.set("message",e.message),Object.assign(Object.assign({},e),{docUrl:n.href})}function Qs(t){var e;if(typeof t=="string")return{message:t,code:U.rpc.internal};if(q(t)){const n=t.errorMessage,s=(e=t.errorCode)!==null&&e!==void 0?e:n.match(/(denied|rejected)/i)?U.provider.userRejectedRequest:void 0;return Object.assign(Object.assign({},t),{message:n,code:s,data:{method:t.method}})}return t}class Xs extends xn{}var er=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n};class En extends Xs{constructor(e){var{metadata:n}=e,s=e.preference,{keysUrl:i}=s,r=er(s,["keysUrl"]);super(),this.signer=null,this.isCoinbaseWallet=!0,this.metadata=n,this.preference=r,this.communicator=new Ys({url:i,metadata:n,preference:r});const o=Hs();o&&(this.signer=this.initSigner(o))}async request(e){try{if(Yn(e),!this.signer)switch(e.method){case"eth_requestAccounts":{const n=await this.requestSignerSelection(e),s=this.initSigner(n);await s.handshake(e),this.signer=s,Bs(n);break}case"wallet_sendCalls":{const n=this.initSigner("scw");await n.handshake({method:"handshake"});const s=await n.request(e);return await n.cleanup(),s}case"wallet_getCallsStatus":return Ze(e,Us);case"net_version":return 1;case"eth_chainId":return Q(1);default:throw P.provider.unauthorized("Must call 'eth_requestAccounts' before other methods")}return await this.signer.request(e)}catch(n){const{code:s}=n;return s===U.provider.unauthorized&&this.disconnect(),Promise.reject(Js(n))}}async enable(){return console.warn('.enable() has been deprecated. Please use .request({ method: "eth_requestAccounts" }) instead.'),await this.request({method:"eth_requestAccounts"})}async disconnect(){var e;await((e=this.signer)===null||e===void 0?void 0:e.cleanup()),this.signer=null,K.clearAll(),this.emit("disconnect",P.provider.disconnected("User initiated disconnection"))}requestSignerSelection(e){return Ws({communicator:this.communicator,preference:this.preference,metadata:this.metadata,handshakeRequest:e,callback:this.emit.bind(this)})}initSigner(e){return qs({signerType:e,metadata:this.metadata,communicator:this.communicator,callback:this.emit.bind(this)})}}function Cn(t){if(t){if(!["all","smartWalletOnly","eoaOnly"].includes(t.options))throw new Error(`Invalid options: ${t.options}`);if(t.attribution&&t.attribution.auto!==void 0&&t.attribution.dataSuffix!==void 0)throw new Error("Attribution cannot contain both auto and dataSuffix properties")}}class rr{constructor(e){this.metadata={appName:e.appName||"Dapp",appLogoUrl:e.appLogoUrl||Bn(),appChainIds:e.appChainIds||[]},this.storeLatestVersion(),kn()}makeWeb3Provider(e={options:"all"}){var n;Cn(e);const s={metadata:this.metadata,preference:e};return(n=Jt(s))!==null&&n!==void 0?n:new En(s)}getCoinbaseWalletLogo(e,n=240){return Mn(e,n)}storeLatestVersion(){new K("CBWSDK").setItem("VERSION",re)}}function tr(t){var e;const n={metadata:t.metadata,preference:t.preference};return(e=Jt(n))!==null&&e!==void 0?e:new En(n)}const nr={options:"all"};function ir(t){var e;new K("CBWSDK").setItem("VERSION",re),kn();const s={metadata:{appName:t.appName||"Dapp",appLogoUrl:t.appLogoUrl||"",appChainIds:t.appChainIds||[]},preference:Object.assign(nr,(e=t.preference)!==null&&e!==void 0?e:{})};Cn(s.preference);let i=null;return{getProvider:()=>(i||(i=tr(s)),i)}}export{rr as CoinbaseWalletSDK,ir as createCoinbaseWalletSDK,rr as default};
