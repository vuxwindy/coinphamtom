import{_ as W,G as j,g as K,h as J,i as Q,j as t,w as E,I as Z,y as i,l as g,p as m,s as $,M as L,K as _,r as c,o as ee,N as te,L as ae}from"./index-NVPnfjv5.js";const oe={name:"ArrowGameModern",setup(){const{isWalletConnected:f}=_(),e=c(null);c(!0),c(0),c(0),c(!1),c(!1);const w=c(!1),o=c(!1),h=c(!1),A=computed(()=>({"wallet-status":!0,connected:f.value,disconnected:!f.value})),b=computed(()=>f.value?"Wallet Connected":"Wallet Disconnected"),l=()=>{try{S(),T()}catch(a){console.error("Error initializing game:",a)}},T=()=>{e.value?(e.value.addEventListener("mousedown",p),e.value.addEventListener("mousemove",B),e.value.addEventListener("mouseup",C),e.value.addEventListener("touchstart",k),e.value.addEventListener("touchmove",x),e.value.addEventListener("touchend",I),console.log("Event listeners set up successfully")):console.error("Game area ref not found")},k=a=>{a.preventDefault();const r=a.touches[0];p({clientX:r.clientX,clientY:r.clientY})},x=a=>{if(a.preventDefault(),gameState.isAiming){const r=a.touches[0];B({clientX:r.clientX,clientY:r.clientY})}},I=a=>{a.preventDefault(),C()},Y=()=>{w.value=!0},D=()=>{X(),w.value=!1},N=()=>{w.value=!1},P=()=>{o.value=!0},F=()=>{H(),o.value=!1},O=()=>{o.value=!1},X=()=>{const a=document.getElementById("character");if(!a)return;const s={archer1:{body:"#8B4513",head:"#FFE4C4",legs:"#8B4513"},archer2:{body:"#4A90E2",head:"#FFE4C4",legs:"#4A90E2"},archer3:{body:"#E74C3C",head:"#FFE4C4",legs:"#E74C3C"}}[gameState.selectedCharacter];a.querySelector(".character-body").style.background=`linear-gradient(135deg, ${s.body}, ${s.body}dd)`,a.querySelector(".character-head").style.background=s.head,a.querySelectorAll(".character-leg").forEach(v=>{v.style.background=`linear-gradient(135deg, ${s.legs}, ${s.legs}dd)`})},H=()=>{const a=document.getElementById("bow");if(!a)return;const r={basic:"#8B4513",premium:"#FFD700",legendary:"#FF4500"};a.querySelector(".bow-body").style.background=`linear-gradient(135deg, ${r[gameState.selectedBow]}, ${r[gameState.selectedBow]}dd)`},q=async()=>{if(!f.value){d("Please connect your wallet first!","error");return}if(gameState.ppoBalance>=10)try{await updateBalance(10,"subtract"),gameState.ppoBalance-=10,gameState.arrowsLeft=5,gameState.isGameActive=!0,h.value=!1,S(),d("5 arrows purchased for 10 PPO!","success")}catch{d("Failed to purchase arrows","error")}else d("Not enough PPO! Complete daily tasks to earn more!","error")},z=()=>{gameState.score=0,gameState.hitCount=0,gameState.currentLevel=1,gameState.arrowsLeft=5,gameState.isGameActive=!0,R(),S(),h.value=!1},d=(a,r)=>{const s=document.createElement("div"),n={success:"#00ff88",error:"#ff6b6b",info:"#4a90e2"};s.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${n[r]||n.info};
        color: white;
        padding: 15px 25px;
        border-radius: 10px;
        font-weight: bold;
        z-index: 10000;
        animation: slideIn 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      `,s.textContent=a,document.body.appendChild(s),setTimeout(()=>{s.remove()},3e3)},p=a=>{if(!gameState.isGameActive||gameState.arrowsLeft<=0)return;gameState.isAiming=!0,gameState.aimStartX=a.clientX,gameState.aimStartY=a.clientY;const r=document.getElementById("arrow"),s=document.getElementById("aimingLine"),n=document.getElementById("bow");r&&(r.style.display="block"),s&&(s.style.display="block"),n&&n.classList.add("drawing")},B=a=>{if(!gameState.isAiming)return;const r=a.clientX-gameState.aimStartX,s=a.clientY-gameState.aimStartY,n=Math.atan2(s,r),v=Math.min(Math.sqrt(r*r+s*s)/10,50),u=document.getElementById("arrow");u&&(u.style.transform=`rotate(${n}rad) translateX(${v}px)`);const y=document.getElementById("aimingLine");y&&(y.style.transform=`rotate(${n}rad)`);const G=document.getElementById("bowString");if(G){const V=Math.min(v/30,1.5);G.style.transform=`rotate(${n}rad) scaleY(${1+V})`}},C=()=>{if(!gameState.isAiming||!gameState.isGameActive||gameState.arrowsLeft<=0)return;gameState.isAiming=!1,gameState.arrowsLeft--;const a=document.getElementById("arrow"),r=document.getElementById("aimingLine"),s=document.getElementById("bow"),n=document.getElementById("bowString");a&&(a.style.display="none"),r&&(r.style.display="none"),s&&s.classList.remove("drawing"),n&&(n.style.transform="rotate(0rad) scaleY(1)");const v=Math.random()*100;let u=30;if(gameState.selectedBow==="premium"&&(u=50),gameState.selectedBow==="legendary"&&(u=80),v<=u){if(gameState.hitCount++,gameState.score+=Math.floor(gameState.currentLevel*10),gameState.hitCount%5===0){gameState.currentLevel++,d(`Level Up! Now Level ${gameState.currentLevel}`,"success");const y=Math.floor(gameState.currentLevel*2);gameState.ppoBalance+=y,d(`Level Up Reward: +${y} PPO!`,"success")}setTimeout(()=>{M("BULLSEYE!","#ffd700")},1e3)}else setTimeout(()=>{M("MISS!","#ff6b6b")},1e3);S(),gameState.arrowsLeft<=0&&setTimeout(()=>{U()},2e3)},M=(a,r)=>{const s=document.createElement("div");s.className="hit-effect",s.innerHTML=`<div class="hit-text" style="color: ${r}">${a}</div>`,s.style.left="50%",s.style.top="50%",s.style.transform="translate(-50%, -50%)";const n=document.querySelector(".game-area");n&&(n.appendChild(s),setTimeout(()=>{s.remove()},1e3))},U=()=>{gameState.isGameActive=!1,h.value=!0,gameState.score>gameState.highScore&&(gameState.highScore=gameState.score,localStorage.setItem("highScore",gameState.highScore),d("New High Score!","success"))},R=()=>{gameState.stuckArrows.forEach(a=>{a.parentNode&&a.parentNode.removeChild(a)}),gameState.stuckArrows=[]},S=()=>{const a=document.getElementById("arrowDisplay");if(a){a.innerHTML="";for(let s=0;s<5;s++){const n=document.createElement("i");n.className=`fas fa-arrow-right arrow-icon ${s>=gameState.arrowsLeft?"used":""}`,a.appendChild(n)}}const r=document.getElementById("buyArrowsBtn");r&&(r.disabled=gameState.ppoBalance<10)};return ee(()=>{try{console.log("Component mounted, initializing game..."),te(()=>{console.log("DOM updated, checking game area ref:",!!e.value),setTimeout(()=>{const a=document.getElementById("character"),r=document.getElementById("bow"),s=document.getElementById("target");console.log("Debug - Elements found:",{character:!!a,bow:!!r,target:!!s,gameAreaRef:!!e.value}),a&&console.log("Character element:",a),r&&console.log("Bow element:",r),s&&console.log("Target element:",s),e.value&&console.log("Game area ref:",e.value),l(),S()},100)}),gameState.ppoBalance=userBalance.value}catch(a){console.warn("Game initialization error:",a)}}),ae(()=>{try{e.value&&(e.value.removeEventListener("mousedown",p),e.value.removeEventListener("mousemove",B),e.value.removeEventListener("mouseup",C),e.value.removeEventListener("touchstart",k),e.value.removeEventListener("touchmove",x),e.value.removeEventListener("touchend",I))}catch(a){console.warn("Game cleanup error:",a)}}),{gameArea:e,score:computed(()=>gameState.score),highScore:computed(()=>gameState.highScore),arrowsLeft:computed(()=>gameState.arrowsLeft),ppoBalance:computed(()=>gameState.ppoBalance),currentLevel:computed(()=>gameState.currentLevel),showCharacterSelector:w,showBowSelector:o,showGameOverModal:h,selectedCharacter:computed(()=>gameState.selectedCharacter),selectedBow:computed(()=>gameState.selectedBow),walletStatusClass:A,walletStatusText:b,selectCharacter:Y,confirmCharacter:D,closeCharacterSelector:N,selectBow:P,confirmBow:F,closeBowSelector:O,buyArrows:q,restartGame:z}}},se={class:"arrow-game-modern"},re={class:"game-container"},le={class:"game-header"},ne={class:"game-stats"},ie={class:"stat-card"},ce={id:"highScore"},de={class:"stat-card"},me={id:"currentLevel"},ve={class:"stat-card score-display"},ue={id:"score"},ge={class:"game-area",ref:"gameArea"},fe={class:"ppo-balance"},we={class:"ppo-amount",id:"ppoBalance"},he={class:"game-controls"},Se=["disabled"],ye={class:"character-selector",id:"characterSelector"},be={class:"character-grid"},pe={class:"bow-selector",id:"bowSelector"},Be={class:"bow-grid"},Ce={class:"game-over-modal",id:"gameOverModal"},Ee={class:"modal-content"},Le={class:"final-score",id:"finalScore"};function Ae(f,e,w,o,h,A){const b=j("router-link");return J(),K("div",se,[Q(b,{to:"/",class:"back-button"},{default:Z(()=>[...e[15]||(e[15]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),i("Back to Home ",-1)])]),_:1}),t("div",{class:m(["wallet-status",o.walletStatusClass]),id:"walletStatus"},[e[16]||(e[16]=t("i",{class:"fas fa-wallet me-1"},null,-1)),i(g(o.walletStatusText),1)],2),t("div",re,[t("div",le,[e[23]||(e[23]=t("div",{class:"game-title"},[t("i",{class:"fas fa-crosshairs"}),i(" PPO Archery ")],-1)),t("div",ne,[t("div",ie,[e[18]||(e[18]=t("i",{class:"fas fa-trophy"},null,-1)),t("span",null,[e[17]||(e[17]=i("High: ",-1)),t("span",ce,g(o.highScore),1)])]),t("div",de,[e[20]||(e[20]=t("i",{class:"fas fa-star"},null,-1)),t("span",null,[e[19]||(e[19]=i("Level: ",-1)),t("span",me,g(o.currentLevel),1)])]),t("div",ve,[e[22]||(e[22]=t("i",{class:"fas fa-bullseye"},null,-1)),t("span",null,[e[21]||(e[21]=i("Score: ",-1)),t("span",ue,g(o.score),1)])])])]),t("div",ge,[e[28]||(e[28]=$('<div class="character" id="character" data-v-49186631><div class="character-body" data-v-49186631></div><div class="character-head" data-v-49186631><div class="character-eyes" data-v-49186631></div><div class="character-mouth" data-v-49186631></div></div><div class="character-arms" data-v-49186631><div class="character-arm left" data-v-49186631></div><div class="character-arm right" data-v-49186631></div></div><div class="character-hands" data-v-49186631><div class="character-hand left" data-v-49186631></div><div class="character-hand right" data-v-49186631></div></div><div class="character-legs" data-v-49186631><div class="character-leg left" data-v-49186631></div><div class="character-leg right" data-v-49186631></div></div><div class="character-feet" data-v-49186631><div class="character-foot left" data-v-49186631></div><div class="character-foot right" data-v-49186631></div></div></div><div class="bow" id="bow" data-v-49186631><div class="bow-body" data-v-49186631></div><div class="bow-string" id="bowString" data-v-49186631></div></div><div class="aiming-line" id="aimingLine" data-v-49186631></div><div class="arrow" id="arrow" data-v-49186631></div><div class="flying-arrow" id="flyingArrow" data-v-49186631></div><div class="target" id="target" data-v-49186631><div class="target-ring outer" data-v-49186631></div><div class="target-ring middle" data-v-49186631></div><div class="target-ring inner" data-v-49186631></div><div class="target-ring bullseye" data-v-49186631></div></div><div class="arrow-counter" data-v-49186631><h3 data-v-49186631><i class="fas fa-arrows-alt" data-v-49186631></i> Arrows</h3><div class="arrow-display" id="arrowDisplay" data-v-49186631></div></div>',7)),t("div",fe,[e[24]||(e[24]=t("h3",null,[t("i",{class:"fas fa-coins"}),i(" PPO")],-1)),t("div",we,g(o.ppoBalance),1)]),t("div",he,[t("button",{class:"control-btn",onClick:e[0]||(e[0]=(...l)=>o.selectCharacter&&o.selectCharacter(...l))},[...e[25]||(e[25]=[t("i",{class:"fas fa-user"},null,-1),i(" Character ",-1)])]),t("button",{class:"control-btn",onClick:e[1]||(e[1]=(...l)=>o.selectBow&&o.selectBow(...l))},[...e[26]||(e[26]=[t("i",{class:"fas fa-crosshairs"},null,-1),i(" Bow ",-1)])]),t("button",{class:"control-btn",onClick:e[2]||(e[2]=(...l)=>o.buyArrows&&o.buyArrows(...l)),disabled:o.ppoBalance<10,id:"buyArrowsBtn"},[...e[27]||(e[27]=[t("i",{class:"fas fa-shopping-cart"},null,-1),i(" Buy Arrows ",-1)])],8,Se)]),e[29]||(e[29]=t("div",{class:"instructions"},[t("i",{class:"fas fa-mouse"}),i(" Click and drag to aim, release to shoot! ")],-1))],512)]),E(t("div",ye,[e[33]||(e[33]=t("h2",null,"Choose Your Character",-1)),t("div",be,[t("div",{class:m(["character-option",{selected:o.selectedCharacter==="archer1"}]),onClick:e[3]||(e[3]=l=>o.selectedCharacter="archer1")},[...e[30]||(e[30]=[t("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #8B4513, #A0522D)","border-radius":"50%",margin:"0 auto 10px"}},null,-1),t("span",null,"Archer",-1)])],2),t("div",{class:m(["character-option",{selected:o.selectedCharacter==="archer2"}]),onClick:e[4]||(e[4]=l=>o.selectedCharacter="archer2")},[...e[31]||(e[31]=[t("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #4A90E2, #357ABD)","border-radius":"50%",margin:"0 auto 10px"}},null,-1),t("span",null,"Ranger",-1)])],2),t("div",{class:m(["character-option",{selected:o.selectedCharacter==="archer3"}]),onClick:e[5]||(e[5]=l=>o.selectedCharacter="archer3")},[...e[32]||(e[32]=[t("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #E74C3C, #C0392B)","border-radius":"50%",margin:"0 auto 10px"}},null,-1),t("span",null,"Hunter",-1)])],2)]),t("button",{class:"control-btn",onClick:e[6]||(e[6]=(...l)=>o.confirmCharacter&&o.confirmCharacter(...l))},"Confirm"),t("button",{class:"control-btn",onClick:e[7]||(e[7]=(...l)=>o.closeCharacterSelector&&o.closeCharacterSelector(...l))},"Cancel")],512),[[L,o.showCharacterSelector]]),E(t("div",pe,[e[37]||(e[37]=t("h2",null,"Choose Your Bow",-1)),t("div",Be,[t("div",{class:m(["bow-option",{selected:o.selectedBow==="basic"}]),onClick:e[8]||(e[8]=l=>o.selectedBow="basic")},[...e[34]||(e[34]=[t("i",{class:"fas fa-crosshairs"},null,-1),t("div",null,"Basic Bow",-1),t("small",null,"Standard accuracy",-1)])],2),t("div",{class:m(["bow-option",{selected:o.selectedBow==="premium"}]),onClick:e[9]||(e[9]=l=>o.selectedBow="premium")},[...e[35]||(e[35]=[t("i",{class:"fas fa-crosshairs"},null,-1),t("div",null,"Premium Bow",-1),t("small",null,"+20% accuracy",-1)])],2),t("div",{class:m(["bow-option",{selected:o.selectedBow==="legendary"}]),onClick:e[10]||(e[10]=l=>o.selectedBow="legendary")},[...e[36]||(e[36]=[t("i",{class:"fas fa-crosshairs"},null,-1),t("div",null,"Legendary Bow",-1),t("small",null,"+50% accuracy",-1)])],2)]),t("button",{class:"control-btn",onClick:e[11]||(e[11]=(...l)=>o.confirmBow&&o.confirmBow(...l))},"Confirm"),t("button",{class:"control-btn",onClick:e[12]||(e[12]=(...l)=>o.closeBowSelector&&o.closeBowSelector(...l))},"Cancel")],512),[[L,o.showBowSelector]]),E(t("div",Ce,[t("div",Ee,[e[40]||(e[40]=t("h2",null,[t("i",{class:"fas fa-gamepad"}),i(" Game Over!")],-1)),t("div",Le,"Score: "+g(o.score),1),e[41]||(e[41]=t("p",null,"You've run out of arrows!",-1)),t("button",{class:"control-btn",onClick:e[13]||(e[13]=(...l)=>o.restartGame&&o.restartGame(...l))},[...e[38]||(e[38]=[t("i",{class:"fas fa-redo"},null,-1),i(" Play Again ",-1)])]),t("button",{class:"control-btn",onClick:e[14]||(e[14]=(...l)=>o.buyArrows&&o.buyArrows(...l))},[...e[39]||(e[39]=[t("i",{class:"fas fa-shopping-cart"},null,-1),i(" Buy More Arrows ",-1)])])])],512),[[L,o.showGameOverModal]])])}const xe=W(oe,[["render",Ae],["__scopeId","data-v-49186631"]]);export{xe as default};
