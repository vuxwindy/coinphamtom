import{_ as ee,u as ae,aV as se,bC as te,e as re,r as h,C as U,o as oe,g as i,h as d,i as $,s as A,n as O,k as le,j as e,bf as ne,l as o,y as v,F as q,m as N,p as ie,q as de,f as B,ak as Y,dA as ce,dB as ve,dC as ue,dD as fe,dE as pe,dF as _e,dG as he,dH as me,dI as ge,dJ as ye,dK as we,dL as be,dM as Re,dN as Ce,dO as Pe,dP as ke,dQ as xe,dR as Ee,dS as De,dT as Fe,dU as Se,dV as Te,dW as Ie,dX as Le,dY as Ue,dZ as $e,d_ as Ae,d$ as Oe,e0 as Ve,e1 as qe,e2 as Ne,e3 as Be,e4 as Ye,e5 as We,e6 as je,e7 as Qe,e8 as Je,e9 as Me,ea as He,eb as Ke,ec as ze,ed as Ge,ee as Xe,ef as Ze}from"./index-NVPnfjv5.js";const W=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:ce,Bytes:ve,CollectionReference:ue,DocumentReference:fe,DocumentSnapshot:pe,FieldPath:_e,FieldValue:he,Firestore:me,FirestoreError:ge,GeoPoint:ye,Query:we,QueryCompositeFilterConstraint:be,QueryConstraint:Re,QueryDocumentSnapshot:Ce,QueryFieldFilterConstraint:Pe,QueryLimitConstraint:ke,QueryOrderByConstraint:xe,QuerySnapshot:Ee,SnapshotMetadata:De,Timestamp:Fe,VectorValue:Se,_AutoId:Te,_ByteString:Ie,_DatabaseId:Le,_DocumentKey:Ue,_EmptyAuthCredentialsProvider:$e,_FieldPath:Ae,_cast:Oe,_logWarn:Ve,_validateIsNotUsedTogether:qe,collection:Ne,connectFirestoreEmulator:Be,doc:Ye,ensureFirestoreConfigured:We,executeWrite:je,getDoc:Qe,getDocs:Je,getFirestore:Me,limit:He,orderBy:Ke,query:ze,setDoc:Ge,updateDoc:Xe,where:Ze},Symbol.toStringTag,{value:"Module"})),ea={class:"referral-page"},aa={key:0,class:"wallet-notice-section padding-large"},sa={class:"container"},ta={class:"row justify-content-center"},ra={class:"col-lg-6"},oa={class:"wallet-notice-card"},la={class:"connect-btn"},na={key:1},ia={class:"referral-stats padding-large"},da={class:"container"},ca={class:"row"},va={class:"col-lg-3 col-md-6 mb-4"},ua={class:"stat-card"},fa={class:"stat-content"},pa={class:"stat-value"},_a={class:"col-lg-3 col-md-6 mb-4"},ha={class:"stat-card"},ma={class:"stat-content"},ga={class:"stat-value"},ya={class:"col-lg-3 col-md-6 mb-4"},wa={class:"stat-card"},ba={class:"stat-content"},Ra={class:"stat-value"},Ca={class:"col-lg-3 col-md-6 mb-4"},Pa={class:"stat-card"},ka={class:"stat-content"},xa={class:"stat-value"},Ea={class:"referral-code-section padding-large bg-dark"},Da={class:"container"},Fa={class:"row"},Sa={class:"col-lg-8 mx-auto"},Ta={class:"referral-code-card"},Ia={class:"code-display"},La={class:"code-input"},Ua=["value"],$a={class:"referral-link-section"},Aa={class:"link-input"},Oa=["value"],Va={class:"referral-list padding-large bg-dark"},qa={class:"container"},Na={class:"row"},Ba={class:"col-12"},Ya={class:"referral-table"},Wa={class:"table-cell"},ja={class:"user-info"},Qa=["src","alt"],Ja={class:"user-details"},Ma={class:"table-cell"},Ha={class:"table-cell"},Ka={class:"table-cell"},za={class:"reward-amount"},Ga={key:0,class:"empty-state"},Xa={class:"referral-leaderboard padding-large"},Za={class:"container"},es={class:"row"},as={class:"col-12"},ss={class:"leaderboard"},ts={class:"leader-rank"},rs={class:"rank-number"},os={class:"leader-info"},ls=["src","alt"],ns={class:"leader-details"},is={class:"leader-rewards"},ds={class:"reward-total"},cs={__name:"Referral",setup(vs){ae();const{currentUser:j}=B(),{address:m}=se(),g=te(),R=re(()=>!!m.value),l=h(""),V=h(!1),c=h({totalReferrals:0,totalEarnings:0,activeReferrals:0,conversionRate:0}),f=h([]),p=h([]),y=async()=>{try{const{getFirestore:s,collection:a,query:t,orderBy:_,limit:k,getDocs:x}=await Y(async()=>{const{getFirestore:n,collection:r,query:T,orderBy:I,limit:L,getDocs:Z}=await Promise.resolve().then(()=>W);return{getFirestore:n,collection:r,query:T,orderBy:I,limit:L,getDocs:Z}},void 0),E=s(),D=a(E,"users"),F=t(D,_("referralCount","desc"),k(10)),S=await x(F),b=[];S.forEach(n=>{const r=n.data();r.referralCount>0&&b.push({id:n.id,name:r.displayName||"Anonymous User",avatar:r.photoURL||"/src/assets/images/default-avatar.png",referrals:r.referralCount||0,totalEarnings:r.referralEarnings||0})}),b.length===0?p.value=[{id:1,name:"No Top Referrers Yet",avatar:"/src/assets/images/default-avatar.png",referrals:0,totalEarnings:0,note:"Top referrers will appear here once users start referring others."}]:p.value=b}catch(s){console.error("Failed to load top referrers:",s),p.value=[{id:1,name:"Loading Error",avatar:"/src/assets/images/default-avatar.png",referrals:0,totalEarnings:0,note:"Failed to load top referrers data."}]}},u=s=>`https://pixelpayot.com/signup?ref=${s}`,w=async()=>{if(m.value)try{V.value=!0;const{getUserData:s}=B(),a=await s();if(a.success){const t=a.data;l.value=t.referralCode||"",await C(t),await P(t),await y()}else l.value="",await C(),await P(),await y()}catch(s){console.error("Failed to load referral data:",s),l.value="",await C(),await P(),await y()}finally{V.value=!1}},C=async(s=null)=>{try{let a={totalReferrals:0,totalEarnings:0,activeReferrals:0,conversionRate:0};s?a={totalReferrals:s.referralCount||0,totalEarnings:s.referralEarnings||0,activeReferrals:s.referralCount||0,conversionRate:s.referralCount>0?85:0}:a={totalReferrals:0,totalEarnings:0,activeReferrals:0,conversionRate:0},c.value=a}catch(a){console.error("Failed to load referral stats:",a),c.value={totalReferrals:0,totalEarnings:0,activeReferrals:0,conversionRate:0}}},P=async(s=null)=>{try{let a=[];if(s&&s.referralCount>0){const{getFirestore:t,collection:_,query:k,where:x,getDocs:E}=await Y(async()=>{const{getFirestore:n,collection:r,query:T,where:I,getDocs:L}=await Promise.resolve().then(()=>W);return{getFirestore:n,collection:r,query:T,where:I,getDocs:L}},void 0),D=t(),F=_(D,"users"),S=k(F,x("referredBy","==",s.referralCode));(await E(S)).forEach(n=>{const r=n.data();a.push({id:n.id,name:r.displayName||"Anonymous User",email:r.email||"No email",avatar:r.photoURL||"/src/assets/images/default-avatar.png",joinedDate:r.createdAt?new Date(r.createdAt.toDate()):new Date,status:"active",reward:5})}),a.length===0&&(a=[{id:1,name:"Referral Data Loading",email:"loading@example.com",avatar:"/src/assets/images/default-avatar.png",joinedDate:new Date,status:"active",reward:5,note:`You have ${s.referralCount} referral(s). Referral details will be displayed here.`}])}else a=[{id:1,name:"No Referrals Yet",email:"noreferrals@example.com",avatar:"/src/assets/images/default-avatar.png",joinedDate:new Date,status:"pending",reward:0,note:"Share your referral code to start earning rewards!"}];f.value=a}catch(a){console.error("Failed to load referrals list:",a),f.value=[{id:1,name:"Loading Error",email:"error@example.com",avatar:"/src/assets/images/default-avatar.png",joinedDate:new Date,status:"error",reward:0,note:"Failed to load referral data."}]}},Q=async()=>{try{await navigator.clipboard.writeText(l.value),g.success("Referral code copied to clipboard!")}catch(s){console.error("Failed to copy referral code:",s),g.error("Failed to copy referral code")}},J=async()=>{try{const s=u(l.value);await navigator.clipboard.writeText(s),g.success("Referral link copied to clipboard!")}catch(s){console.error("Failed to copy referral link:",s),g.error("Failed to copy referral link")}},M=()=>{const s=u(l.value);window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent("Join me on PixelPayot! Use my referral link and get 2 $PPO bonus!")}&url=${encodeURIComponent(s)}`)},H=()=>{const s=u(l.value);window.open(`https://t.me/share/url?url=${encodeURIComponent(s)}&text=${encodeURIComponent("Join me on PixelPayot! Use my referral link and get 2 $PPO bonus!")}`)},K=()=>{const s=u(l.value);window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}&quote=${encodeURIComponent("Join me on PixelPayot! Use my referral link and get 2 $PPO bonus!")}`)},z=()=>{const s=u(l.value);window.open(`https://wa.me/?text=${encodeURIComponent("Join me on PixelPayot! Use my referral link and get 2 $PPO bonus!"+" "+s)}`)},G=()=>{document.querySelector(".referral-code-section").scrollIntoView({behavior:"smooth"})},X=s=>new Date(s).toLocaleDateString();return U(m,(s,a)=>{s&&s!==a&&w()}),oe(async()=>{R.value&&(await w(),await y())}),U(m,async(s,a)=>{s!==a&&await w()}),U(j,async s=>{s?await w():(l.value="",c.value={totalReferrals:0,totalEarnings:0,activeReferrals:0,conversionRate:0},f.value=[],p.value=[])}),(s,a)=>(d(),i("div",ea,[$(le),a[29]||(a[29]=A('<section class="referral-hero padding-large" data-v-342f4e55><div class="container" data-v-342f4e55><div class="row" data-v-342f4e55><div class="col-12" data-v-342f4e55><div class="referral-header text-center" data-v-342f4e55><h1 class="referral-title" data-v-342f4e55>Referral Program</h1><p class="referral-subtitle" data-v-342f4e55> Invite friends and earn rewards together! </p><div class="referral-banner" data-v-342f4e55><div class="banner-content" data-v-342f4e55><h2 data-v-342f4e55>Earn 5 $PPO for each friend who joins!</h2><p data-v-342f4e55> Plus, your friends get 2 $PPO bonus when they sign up with your code </p></div></div></div></div></div></div></section>',1)),R.value?O("",!0):(d(),i("section",aa,[e("div",sa,[e("div",ta,[e("div",ra,[e("div",oa,[a[0]||(a[0]=e("div",{class:"notice-icon"},[e("i",{class:"fas fa-wallet"})],-1)),a[1]||(a[1]=e("h3",null,"Connect Your Wallet",-1)),a[2]||(a[2]=e("p",null," Please connect your wallet to view your referral data and start earning rewards ",-1)),e("div",la,[$(ne)])])])])])])),R.value?(d(),i("div",na,[e("section",ia,[e("div",da,[e("div",ca,[e("div",va,[e("div",ua,[a[4]||(a[4]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-users"})],-1)),e("div",fa,[e("h3",pa,o(c.value.totalReferrals),1),a[3]||(a[3]=e("p",{class:"stat-label"},"Total Referrals",-1))])])]),e("div",_a,[e("div",ha,[a[6]||(a[6]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-coins"})],-1)),e("div",ma,[e("h3",ga,o(c.value.totalEarnings),1),a[5]||(a[5]=e("p",{class:"stat-label"},"Total Earnings ($PPO)",-1))])])]),e("div",ya,[e("div",wa,[a[8]||(a[8]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-trophy"})],-1)),e("div",ba,[e("h3",Ra,o(c.value.activeReferrals),1),a[7]||(a[7]=e("p",{class:"stat-label"},"Active Referrals",-1))])])]),e("div",Ca,[e("div",Pa,[a[10]||(a[10]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-chart-line"})],-1)),e("div",ka,[e("h3",xa,o(c.value.conversionRate)+"% ",1),a[9]||(a[9]=e("p",{class:"stat-label"},"Conversion Rate",-1))])])])])])]),e("section",Ea,[e("div",Da,[e("div",Fa,[e("div",Sa,[e("div",Ta,[a[20]||(a[20]=e("h2",{class:"section-title text-center"},"Your Referral Code",-1)),e("div",Ia,[e("div",La,[e("input",{type:"text",value:l.value,class:"form-control",readonly:""},null,8,Ua),e("button",{class:"btn btn-primary",onClick:Q},[...a[11]||(a[11]=[e("i",{class:"fas fa-copy"},null,-1),v(" Copy Code ",-1)])])]),e("div",$a,[a[13]||(a[13]=e("h5",null,"Your Referral Link",-1)),e("div",Aa,[e("input",{type:"text",value:u(l.value),class:"form-control",readonly:""},null,8,Oa),e("button",{class:"btn btn-secondary",onClick:J},[...a[12]||(a[12]=[e("i",{class:"fas fa-copy"},null,-1),v(" Copy Link ",-1)])])])]),a[14]||(a[14]=e("div",{class:"code-info"},[e("p",null," Share this code or link with your friends to start earning rewards! ")],-1))]),e("div",{class:"share-section"},[a[19]||(a[19]=e("h4",null,"Quick Share",-1)),e("div",{class:"share-buttons"},[e("button",{class:"btn btn-social btn-twitter",onClick:M},[...a[15]||(a[15]=[e("i",{class:"fab fa-twitter"},null,-1),v(" Twitter ",-1)])]),e("button",{class:"btn btn-social btn-telegram",onClick:H},[...a[16]||(a[16]=[e("i",{class:"fab fa-telegram"},null,-1),v(" Telegram ",-1)])]),e("button",{class:"btn btn-social btn-facebook",onClick:K},[...a[17]||(a[17]=[e("i",{class:"fab fa-facebook"},null,-1),v(" Facebook ",-1)])]),e("button",{class:"btn btn-social btn-whatsapp",onClick:z},[...a[18]||(a[18]=[e("i",{class:"fab fa-whatsapp"},null,-1),v(" WhatsApp ",-1)])])])])])])])])]),a[28]||(a[28]=A('<section class="referral-rewards padding-large" data-v-342f4e55><div class="container" data-v-342f4e55><div class="row" data-v-342f4e55><div class="col-12" data-v-342f4e55><h2 class="section-title text-center" data-v-342f4e55>How It Works</h2><div class="rewards-grid" data-v-342f4e55><div class="reward-card" data-v-342f4e55><div class="reward-icon" data-v-342f4e55><i class="fas fa-user-plus" data-v-342f4e55></i></div><h4 data-v-342f4e55>Step 1: Share Your Code</h4><p data-v-342f4e55>Share your unique referral code with friends and family</p></div><div class="reward-card" data-v-342f4e55><div class="reward-icon" data-v-342f4e55><i class="fas fa-user-check" data-v-342f4e55></i></div><h4 data-v-342f4e55>Step 2: Friends Join</h4><p data-v-342f4e55>Your friends sign up using your referral code</p></div><div class="reward-card" data-v-342f4e55><div class="reward-icon" data-v-342f4e55><i class="fas fa-gift" data-v-342f4e55></i></div><h4 data-v-342f4e55>Step 3: Earn Rewards</h4><p data-v-342f4e55>You both receive $PPO tokens as rewards</p></div></div></div></div></div></section>',1)),e("section",Va,[e("div",qa,[e("div",Na,[e("div",Ba,[a[26]||(a[26]=e("h2",{class:"section-title text-center"},"Your Referrals",-1)),e("div",Ya,[a[25]||(a[25]=A('<div class="table-header" data-v-342f4e55><div class="header-cell" data-v-342f4e55>User</div><div class="header-cell" data-v-342f4e55>Date Joined</div><div class="header-cell" data-v-342f4e55>Status</div><div class="header-cell" data-v-342f4e55>Reward</div></div>',1)),(d(!0),i(q,null,N(f.value,t=>(d(),i("div",{key:t.id,class:"table-row"},[e("div",Wa,[e("div",ja,[e("img",{src:t.avatar,alt:t.name,class:"user-avatar"},null,8,Qa),e("div",Ja,[e("h5",null,o(t.name),1),e("small",null,o(t.email),1)])])]),e("div",Ma,o(X(t.joinedDate)),1),e("div",Ha,[e("span",{class:ie(["status-badge",t.status])},o(t.status),3)]),e("div",Ka,[e("span",za,"+"+o(t.reward)+" $PPO",1)])]))),128)),f.value.length===0?(d(),i("div",Ga,[a[22]||(a[22]=e("div",{class:"empty-icon"},[e("i",{class:"fas fa-users"})],-1)),a[23]||(a[23]=e("h3",null,"No Referrals Yet",-1)),a[24]||(a[24]=e("p",null,"Start sharing your referral code to earn rewards!",-1)),e("button",{class:"btn btn-primary",onClick:G},[...a[21]||(a[21]=[e("i",{class:"fas fa-share"},null,-1),v(" Share Your Code ",-1)])])])):O("",!0)])])])])]),e("section",Xa,[e("div",Za,[e("div",es,[e("div",as,[a[27]||(a[27]=e("h2",{class:"section-title text-center"},"Top Referrers",-1)),e("div",ss,[(d(!0),i(q,null,N(p.value,(t,_)=>(d(),i("div",{key:t.id,class:"leaderboard-item"},[e("div",ts,[e("span",rs,o(_+1),1)]),e("div",os,[e("img",{src:t.avatar,alt:t.name,class:"leader-avatar"},null,8,ls),e("div",ns,[e("h5",null,o(t.name),1),e("p",null,o(t.referrals)+" referrals",1)])]),e("div",is,[e("span",ds,o(t.totalEarnings)+" $PPO",1)])]))),128))])])])])])])):O("",!0),$(de)]))}},fs=ee(cs,[["__scopeId","data-v-342f4e55"]]);export{fs as default};
